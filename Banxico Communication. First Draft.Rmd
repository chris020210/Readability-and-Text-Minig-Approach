---
title: 'Banco de México''s Communication: A Readability and Perspicuity Approach.'
author: "Christian Admin De la Huerta Avila"
output:
  pdf_document:
    latex_engine: xelatex
    df_print: paged
    fig_height: 4
  word_document: default
bibliography: Bib.bib
csl: harvard.csl
nocite: |
  @huangCentralBankCommunication2021
fontsize: 12pt
linestrech: 1.5
citecolor: cyan
linkcolor: cyan
urlcolor: cyan
header-includes:
- \usepackage{float}
- \usepackage{wrapfig}
---


```{r setup, include=FALSE}

# Libraries 
# Before get start, we need to load the `KoRpus` library. In addition, we will
# use the `koRpus.lang.en` and `koRpus.lang.en` libraries to identify the
# languages of the statements, in this case, English and Spanish 
library(koRpus)
library(tidyverse)
library(koRpus.lang.en)
#library(koRpus.lang.es)
library(knitr)
library(kableExtra)
library(ggthemes)
library(tinytex)
#library(ggsci)
library(extrafont)
loadfonts(device = "win")


### Setup ----
#options(encoding = 'UTF-8')# Cambiar locale para prevenir problemas con caracteres especiales
options(scipen=999) # Prevenir notacion cientifica

load("Methodology data2.RData")
Banxico_readability$document[Banxico_readability$document == "IQR"] <- "QIR"
Banxico_readability$document[Banxico_readability$document == "MPD"] <- "MPS"

```


\begin{abstract}

\noindent Central bank communication may potentially improve the effectiveness of monetary policy transmission, and is essential to foster transparency and ensure that these institutions are accountable to the public they serve. However, just providing information to the public does not guarantee that the central bank is conveying a clear message. Therefore, it is crucial, on the one hand, to provide high-quality communication, and on the other, to make the information accessible to a broader audience. The methodology proposed in this paper is along these lines. From the point of view of a broad spectrum of the public, I examine the clarity of the content of Banco de México's main publications: the monetary policy statements, the minutes of the meetings of the Board of Governors, and the quarterly inflation reports. Classical readability and perspicuity measures are computed for these documents for the period from 2011 to 2022. Unit root tests are then performed allowing for one and two endogenous structural breaks in the time series of the clarity of each publication. The findings of the statistical analysis show that there have been significant structural breaks in Banco de México's communication aligned with three major events: the adoption of an Inflation Forecast Targeting scheme in 2018, the update of the General Communication Criteria for the Board of Directors and central bank staff, and the COVID-19 pandemic in 2020. The results also show that these changes have made communication clearer, although it remains inaccessible to the vast majority of the Mexican population.

\end{abstract}


__Keywords__: Banco de México, Central bank communication, Clarity, Readability measures, Structural break.     

__JEL Classification__: C12, C820, E52, E58.


\newpage

\setlength{\parindent}{10mm}
\section{1. Introduction}


For central banks, communication is crucial because it serves two important purposes. First, it may have the power to shape public's expectations of future macroeconomic outcomes, which can impact financial market behavior and, in turn, potentially affect the economy. Central banks can use their communication channels to provide guidance and signals about their future policy actions, which can help to anchor expectations and improve the transmission of monetary policy.

Second, as independent authorities appointed by the executive branch of government, central banks operate outside the realm of direct democratic control. In a democratic society, transparency is essential to ensure that these institutions are accountable to the public they serve. Central bank communication can help to increase transparency by providing information about the central bank's policy decisions, the reasoning behind those decisions, and the economic conditions that influence them.

The latter has been extensively studied by the literature on transparency[^1], leading to the creation of various indicators associated with these issues, and to a consensus that central banks should share information on their objectives, their perspective on economic developments, as well as the monetary policy decision-making process. 

[^1]: See @fryKeyIssuesChoice2000, @blinderHowCentralBanks2001, @geraatsCentralBankTransparency2002[-@geraatsMystiqueCentralBank2007], @eijffingerHowTransparentAre2006, @cihakCentralBanksFinancial2007, @dincerCentralBankTransparency2008[-@dincerCentralBankTransparency2010; -@dincerCentralBankTransparency2014] and @dincerTransparencyMonetaryPolicy2019[-@dincerTrendsMonetaryPolicy2022].


Inflation-targeting central banks, in particular, need to be transparent to foster openness and accountability. However, transparency alone does not guarantee effective communication, and the information shared may not always be easily understood. Given the great power that central banks have to potentially influence expectations and affect the economy, it is not only important to increase the amount of information available but also to make it more accessible. Communication must be perspicuous, intelligible, concise, and relevant. Central banks face the need to convey clear messages that explain their decisions, their rationale, and how monetary policy works. 

To allow for public scrutiny, communication strategies and policies should promote two-way channels, i.e., to encourage dialogue and feedback between the central bank and the public. In addition, these institutions must make their information accessible to a wider audience, not just to highly specialized experts, analysts, and professional watchers who can easily interpret the central bank's message. Studies have shown that macroeconomic outcomes can be improved by aligning households’ and firms’ expectations with a central bank’s policy objectives.[^2]

[^2]: See @deslongchampsReadabilityBankCanada2018.

This means that simple and clear communication can be a powerful tool for central banks to align households' and firms' expectations. By clearly and transparently communicating their goals, perspectives on economic developments, and the decision-making process, central banks can help the public and markets better understand their actions and intentions. This, in turn, can help to build trust and confidence in the central bank, which can improve the effectiveness of monetary policy. Moreover, when households and firms have a better understanding of the central bank's objectives and the factors that influence its decisions, they are more likely to make informed decisions that are in line with the central bank's goals. This can help to reduce the costs of adjustment to changes in monetary policy and can lead to a more stable and predictable economic environment.

In the special case of Mexico's national central bank, Banco de México (Banxico) has made advances towards greater transparency and effective communication over the past two decades. Since the formal adoption of an Inflation Targeting Regime (ITR) in 2001, Banxico has released bulletins explaining its monetary policy decisions, and quarterly reports aimed to analyze inflation and economic developments to meet the objective of maintaining low and stable inflation. From then on, the communication strategy has undergone numerous modifications.

This paper aims to address two important questions: Have there been significant changes in Banco de México's communication over time? Has the information shared by the central bank become more accessible to the majority of the population and to what extent? To answer these questions, I first review the main changes to Banxico's communication strategy in recent years. I then compute classical measures of readability and perspicuity on monetary policy statements, minutes and quarterly inflation reports, which are considered as a proxy for the clarity and intelligibility of central banks' language. With the information gathered, I focus on determining whether there is evidence of a structural break in the readability and perspicuity of Banxico's publications, using time series techniques. In particular, unit root tests are performed that allow for one and two endogenous structural breaks. The results of the structural break analysis suggest that, overall, changes in Banxico's communication have been effective in increasing the clarity of the publications, especially in 2018 and 2020 significant positive changes are found in the central bank's communication. However, there is still room for improvement as publications have not been made accessible to as much of the population as possible.

The rest of the paper is organized as follows. Section 2 summarizes the literature on central bank communication. Section 3 presents the data and reviews Banco de México's communication strategy. Section 4 describes the evolution over the period 2011 to 2022 of the linguistic properties of Banxico's publications according to various measures. Section 5 contains the main statistical analysis of this paper, presenting the structural change tests and their results. Finally, Section 6 concludes with a summary of the findings and implications for central bank communication.


# 2. The central banker's enigma

\noindent Central banking has undergone significant changes over the past few decades. Today, central banks around the world are more independent and transparent than ever before. This wasn't always the case. In the past, central banks were often subject to political pressures and had limited transparency.

Prior to 1980, the consensus was that central bankers should be secretive and mysterious authorities with a high degree of opacity. It was believed that central banks should maintain little or no communication with the public and markets, or if so, convey coded messages extremely difficult to read and understand. 

In the 1960s, economist Milton Friedman famously commented that the most important variables in the central bank's lost function are, on the one hand, avoiding accountancy, and on the other, achieving public prestige.[^3] 

[^3]: See @faustTransparencyCredibilityMonetary2001.

Montagu Norman, former Bank of England chairman, is recognized as having coined the phrase "never excuse, never explain", and it is said that he constantly rejected to testify before the Parliament.[^4] Mervyn King sums up very well the thinking on central bank communication at the end of the 20th century[^5]:

  >> \footnotesize When I joined the Bank of England in 1991, I was fortunate enough to be invited to dine with a group that included Paul Volcker.  At the end of the evening, I asked Paul if he had a word of advice for a new central banker. He replied —in one word— "mystique". That single word encapsulates much of the tradition and wisdom of central banking at that time.

[^4]: See @boyleMontaguNormanBiography1967.

[^5]: @kingMonetaryPolicyTheory2000 as quoted in @lindseyReformOctober19792005.

Even though this view of central banking as full of mysticism, secrecy, and opacity has remained at the heart of some scholars and central bankers, the experience of the "Great Inflation" and developments in Time Inconsistency and Institutional Design Theory highlighted the need for central bankers with a high degree of independence and credibility.[^6]

[^6]: See @kydlandRulesRatherDiscretion1977, @calvoTimeConsistencyOptimal1978, @barroRulesDiscretionReputation1983 and @rogoffOptimalDegreeCommitment1985.


The changes that originated, both in theory and practice, triggered a radical transformation toward greater independence. This included the adoption of inflation targeting schemes, which sought to anchor inflation expectations by publicly announcing a numerical target for inflation. As a result, central banks were able to set clearer and more specific objectives and gain credibility on them. All of these changes were a significant departure from the past, where central banks often kept their goals and methods of operation secret.

While in the 1980s and 1990s the debate was about central bank independence and inflation targets, the growing power of central banks set the need for openness and accountancy. Therefore, the 2000s saw the emergence of quite a bit of literature focused on the transparency of monetary authorities and central bank's communication channels.

Alan Blinder, former Vice Chairman of the Federal Reserve, called this transformation the "Quiet Revolution".[^7] He argued that the shift towards greater openness and transparency would improve the effectiveness of monetary policy. This revolution led to central banks becoming more open and transparent about their operations and decision-making processes. The prototype of the secretive and ambiguous central bank turned to a central bank design that should be open, intelligible and honest.

[^7]: See @blinderQuietRevolutionCentral2004.

The work of Christina and David Romer [-@romerDoesMonetaryPolicy1989] is a seminal contribution to communication literature. Applying the so-called _narrative approach_, they investigate a set of periods in which the Federal Reserve's verbal stance was restrictive. They find that narratives, i.e., the historical record, the descriptions of the process and reasoning that led to the monetary authority's decisions and accounts of the sources of monetary disturbances, are related to multiple macroeconomic outcomes, such as the real effects of monetary shocks.


Later on, Alan Blinder noted, during a lecture at the London School of Economics, that greater openness could improve the effectiveness of monetary policy. He argued that expectations about the central bank's future behavior provide the essential link between short-term and long-term interest rates; in turn, a more open central bank naturally shapes expectations by providing the markets with more information about its view of the fundamental factors guiding monetary policy, becoming more predictable to markets, and making market reactions more predictable to itself.[^9]

[^9]: See @blinderCentralBankingTheory1999.

At the Federal Reserve Jackson Hole Symposium in 2001, Michael Woodford argued that the success of the monetary policy is not so much a matter of effective control of the overnight interest rate, nor effective control of inflation, but of successfully influencing the evolution of market expectations about these variables in the desired way, therefore, transparency is valuable for the effective conduct of monetary policy.[^10]

[^10]: See @woodfordMonetaryPolicyInformation2001.

That same year, Alan Greenspan, historically acknowledged as a master of the esoteric art of central banking, claimed the importance of transparency and communication with the public[^11]:

  >> \footnotesize The historical record indicates that the increased transparency of the Federal Reserve has helped improve the functioning of markets and enhanced our credibility [...] openness is more than just useful in shaping better economic performance. Openness is an obligation of a central bank in a free and democratic society. U.S. elected leaders chose to vest the responsibility for setting monetary policy in an independent entity, the Federal Reserve. Transparency of our activities is the means by which we make ourselves accountable to our fellow citizens to aid them in judging whether we are worthy of that task.
  
[^11]: See @greenspanTransparencyMonetaryPolicy2001.
  
Later, in a thorough analysis, Kohn and Sack [-@kohnCentralBankTalk2004] showed that central bank's talk contain market-relevant information. By testing for volatility in asset prices due to different types of Federal Reserve speaks, they found that statements and policy actions can serve as effective substitutes for one another, at least in the short run. Their analysis conclude that a credible central bank can achieve nearly the same result by implementing a policy action or by promising to implement that action at the next meeting.


As stated by Ben Bernanke, former Fed's chairman, monetary policy is 98 percent talk and only two percent action, hence, the ability to shape market expectations of future policy through public statements is one of the most powerful tools the central banks have.[^13] During his time at the Federal Reserve, he constantly advocated for greater transparency, communication and the formal adoption of inflation targeting.

[^13]: See @bernankeInauguratingNewBlog2015.

Indeed, following the early experience of the Bank of Japan, Bernanke's paper co-authored with Vincent Reinhart and Brian Sack [-@bernankeMonetaryPolicyAlternatives2004] was one of the first to conclude that when primary tools are constrained and can no longer support central bank's objectives, unconventional measures, such as communication and forward guidance, can successfully affect expectations about future policy and longer-term yields, thus providing additional support for monetary policy.

After the first generation of empirical studies, @blinderCentralBankCommunication2008 surveyed the literature existent at the time, pointing out that even when there was no evident consensus about the optimal communication policy, "communication can be an important and powerful part of the central bank’s toolkit since it has the ability to move financial markets, to improve the predictability of monetary policy, and the potential to help the monetary authorities achieve macroeconomic objectives such as low and stable inflation".

Ever since Alan Greenspan stressed to "mumble with great incoherence"[^16], the world of central banking and monetary policy has undergone a major evolution. We have seen the role and impact of central bank communication increase steadily. In the past, central banks used to wonder if there was a good reason to communicate something; now they wonder if there is a good reason not to communicate. In the words of the governor of the Central Bank of Ireland, Gabriel Makhlouf, the days of "mumbling with great incoherence" are over.[^17]


[^16]: These words were uttered by Alan Greenspan during his appearance before the Senate in 1987.
[^17]: See @makhloufEndMumblingIncoherence2020.

Initially communication was perceived as a complement to gain credibility, or to support the effectiveness of the transmission channels when the main tools are limited. Nowadays, in the literature and the world of central banking, there is a clear consensus regarding the role of communication as a tool. While the policy rate is seen as the primary tool to influence directly very short-term interest rates, the central bank's communication is seen as the policy that can potentially influence long-term interest rates. Moreover, the growing importance of financial stability, and better understanding on how market expectations can affect market prices provides a good reason to communicate effectively and clearly.

The growing power of monetary authorities and the importance of market expectations in the transmission of monetary policy has yielded new definitions of monetary policy strategy and the central banker toolkit. With the development of communication tools, a lot of literature has emerged trying to understand the impact of central bank's communication on market expectations, signals on the yield curve and the effective transmission of monetary policy.[^18] 

For example, @campbellMacroeconomicEffectsFederal2012 and @campbellOdysseanForwardGuidance2013, using both an empirical an theoretical approach, showed how the Fed, through public announcements and forward guidance, can successfully influence assets prices and forecast over a variety of many macroeconomics variables. Their work also derived in new definitions of communication and the types of forward guidance a monetary authority can deliver.

[^18]: See @charbonneauForwardGuidanceEffective2015, @smithHasForwardGuidance2015, @mckayPowerForwardGuidance2016, @angeletosForwardGuidanceCommon2018, @dellaricciaUnconventionalMonetaryPolicies2018, @altavillaMeasuringEuroArea2019, @bernankeMonetaryPolicyStrategies2019 and @bernankeNewToolsMonetary2020.


At the same time, new research has focused on the implementation of text mining and text analysis tools. The latter, through Natural Language Processing (NLP) and classical readability tests, aimed to decipher the clarity and semantic content of central bank communication, interpret both the quantity and quality of the communication that central banks deliver through official documents and other central banking-related text. Some of these works emphasize readability and perspicuity (insert bibliography), whereas others scrutinize central bankers' communication by applying machine learning and dictionary techniques(insert bibliography).

@cihakWritingClearlyECB2008 based on an extensive analysis of ECB’s inflation forecasts, inflation targets, and verbal information in monthly bulletins and press statement, conclude that ECB's written communication is clear about 95 percent of the time. @jansenDoesClarityCentral2011 illustrates the importance of transparent communication about monetary policy by comparing the readability statistics of the Federal Reserve Chairman's Humphrey-Hawkins testimonies and their effect on financial market volatility. @bulirMeasuringClarityCentralbank2013[-@bulirWhatDrivesClarity2013] using a similar methodology for press statements and inflation reports of 7 central banks, show that the relationship between the clarity of communications and the broader economic environment has a significant effect, specially for topics such as inflationary risks, forward-looking inflation gap, inflation deviations from the target, and more dissenting votes on monetary policy decissions. Furthermore, they find a negative change in clarity in the aftermath of the GFC, and point out how communication strategies are often linked to country-specific and institution-specific factors. @deslongchampsReadabilityBankCanada2018 highlights that even though the readability of Bank of Canada's publications has improved, they still lag far behind the benchmark of clarity for a vast sector of the population. @ferraraDoesClarityMake2022 provided evidence that clearer ECB´s communication is strongly and robustly correlated with a higher degree of engagement of journalists and social media users, i.e., journalists and social media users tend to talk less about, and engage less with, the ECB when its language is more difficult to understand.

For Latin American central banks @tabordaProceduralTransparencyLatin2015 surveyed the readability of the minutes for Brazil, Chile, Colombia, Mexico and Peru from 1997 to 2013, concluding that there has been a modest evolution in the clarity of these documents. @herradaComunicacionPoliticaMonetaria2020 noted that there are significant challenges in South American central banks' communication. They stressed the need for improving clarity in communication with different types of audiences, especially to approach the youth population, and count with instruments to assess the communication strategy and design. @carottaMonetaryPolicyCommunication2023 find that Uruguay´s central bank readability has improved over time, but there is still room for further improvements in the perspicuity of the messages.

In the especial case of Banxico, not many pieces of research focus on communication. To the extent of my knowledge, only @cermenoQueTanPredecible2011 and @lopezmarmolejoDescifrandoLenguajeBanco2013 approached this topic before. The former estimate an index of the bias of the monetary policy statement, and by incorporating it in a probit regression with the change in the monetary stance in the subsequent period as the dependent variable, they conclude that Banxico's communication is effective in predicting the next decision, but only in the short term.

López Marmolejo constructs a communication index with the identification of relevant phrases in monetary policy statements. By incorporating it as an independent variable in a standard Taylor rule, concludes that Banxico sends pertinent signals to the markets that allow forecasting the monetary policy rate. Furthermore, his study points out that both the market and analysts understand the meaning of the communication, which has contributed to market expectations of interest rates being more congruent with the central bank's vision, as well as closer and more stable in relation to the level finally observed.

This research highlights that Banxico's communication strategy may have the power to potentially influence expectations of future macroeconomic outcomes. In particular, effective and clear communication can reduce the uncertainty of future movements in the monetary stance and contribute to less noise and volatility in financial markets due to the central bank's operation.

This paper contributes to this growing literature by conducting a comprehensive evaluation of official monetary policy statements, minutes and quarterly inflation reports from Banco de México over the period 2011 to 2022. My research differs from similar existing papers, in terms of the central bank under study, the period and the range of documents included. In the following sections, I approach the question whether there have been significant changes in Banxico´s clarity, and if the information shared by the central bank has become more accessible to the majority of the population and to what extent.


# 3. Banco de México's Communication Strategy

\noindent Like many other central banks, Banxico's communication strategy has evolved. Since the early 2000s, the central bank began publishing bulletins informing monetary policy decisions, as well as a quarterly inflation report. This was followed in 2001 by the formal adoption of an Inflation Targeting Regime (ITR). Since then, the communication strategy and design have undergone some changes. The first culminated in 2011, when the central bank, after a gradual decrease in the number of monetary policy meetings per year, determined a calendar with 8 pre-set dates.

At these meetings the Board of Directors can raise, leave unchanged, or cut the policy rate to influence monetary and financial conditions in line with its mandate to maintain low and stable inflation.  In addition, in the event of extreme economic and financial developments that require Banxico's intervention, the Board of Directors may adjust the monetary policy stance at dates other than those established in advance.

After each meeting, Baxico releases the monetary policy statement, which consists of a few pages (no more than 3 at their longest over the period under study) describing international developments since the last meeting, the markets and the economy, both observed and expected inflation, the balance of risks to the inflation forecast and the monetary policy decision itself.

The same year, Banxico started to publish one of the main tools toward greater transparency and effective communication, the minutes of the Board of Directors' meetings. The ones are documents that summarize the discussion of the members during monetary policy meetings, thus providing insight into the decision-making process. From 2011 to the April 2018 decision, the minutes consisted of 4 sections, the first one informed of the place, date, and the name of the attendees; the second one presented material that the Economic Research and Central Bank Operations Departments prepared for the meeting, giving an overview on the international markets, financial conditions, economic activity, and inflation; the third encompassed the bulk of the Board of Directors' discussion, although it did not (and still does not) indicate the name of the member who made the specific comment, and finally, it highlighted the monetary policy decision.

Then, in 2018 the bank shifted its strategy to an Inflation Forecast Targeting (IFT). The same represents a major evolution in the communication design because inflation reports for the first time included the point forecasts of quarterly annual inflation. As stated in the ITR literature[^22], in the theoretical structure of the forecasts, the endogenous determination of the monetary policy is considered, that is, the monetary position is established in such a way that it is congruent with the fulfillment of the inflation forecast in the established horizon. The latter implied that the inflation forecast offers the so-called _Delphic forward guidance_, thus tracking the likely future of monetary policy actions, given the current forecast of the economy and the uncertainty surrounding this forecast.[^23]

[^22]: See @kingMonetaryPolicyUK1994, @svenssonInflationForecastTargeting1997[-@svenssonInflationTargetingMonetary1999; -@svenssonMonetaryPolicyJudgment2005; -@svenssonInflationTargeting2010], @clintonInflationForecastTargetingApplying2015 and @svenssonInflationTargetingLeaning2016[-@svenssonMonetaryPolicyStrategies2020].

[^23]: See @campbellMacroeconomicEffectsFederal2012.

In addition, in this year Banxico updated its communication strategy. As of the May 2018 decision, the minutes keep the first section untouched but continue with the analysis and motivation of the votes of the Committee members, the monetary policy decision, and for the first time began to discloses the identity of the voters, and in case of dissent also incorporate a section explaining the rationale for the dissenters' vote. The material presented by the Economic Research and Central Bank Operations Departments is now included as an appendix.

On top of that, the central bank announced that transcripts of the meetings will be made available to the public three years after the meeting. the Board of Directors adopted a Banxico Speakers approach, publishing transcripts of its members' speeches and public presentations.

In 2020, the General Communication Criteria of the Board of Director and Banxico's staff were updated and made public for the first time. The central bank also established that the press releases, monetary policy statements and minutes would be made clearer and more concise in its extension. Since August 2021, the bank conveyed to publish and update the inflation forecast in every monetary policy statement, and identify the direction of the vote of each of the members who participated in said meeting, indicating the members who adopted the decision taken and, if applicable, those who voted for an alternative decision and what it consisted of. 

Finally, in May 2022 the Board of Directors took a major step by formally delivering verbal _forward guidance_ in the monetary policy statements. Table 1 summarizes the evolution of Banxico's communication strategy.

All of these changes have led to a central bank design more independent and transparent than ever before. However, as reviewed in the previous section, an effective communication strategy does not depend exclusively on the quantity of information disseminated, but also on the quality and clarity of the message. Moreover, not only does this information need to be understandable to market participants and professional analysts, but also to businesses, households and the general public. 

The methodology proposed in this paper is along these lines, and for this purpose I examinate the clarity, from the point of view of a broad spectrum of the public, of the content of the three main documents in which Banxico conveys information on its decisions, perspectives and rationale: the monetary policy statements (MPS), the minutes of the meetings of the Board of Directors (MPM) and the quarterly inflation reports (QIR).

All information was obtained in pdf format from the official website of Banco de México. I choose to analyze the publications in the original Spanish language for two reasons: first, the availability of the documents and, second, to eliminate any bias that might be printed on the translation. After apply any text data technique, is necessary to pre-processes the documents in a classic text editor to obtain a set of plain text data. The filter consists of removing all objects not related to the main text, such as headers, page numbers, title pages, indexes, tables of contents, footnotes, appendices, etc. Despite the many efforts made by scholars and researchers to develop techniques to include graphs, tables, figures, charts and other visual elements in linguistic analysis, no such method is available, so even when this material can add valuable content to the analysis, it is necessary to remove them from the documents.


```{r Table 1 Evolution of Banxico communication strategy, echo=FALSE, message=FALSE, warning=FALSE, paged.print=TRUE}
Banxico_Communication <- data.frame("Year" = c(2000,2000,2001,rep(2003,2),2006,2008,2008,2010,
                                    rep(2011,3),2016, 2017,rep(2018,6),rep(2020,2),rep(2021,3),2022),
                           "Improvements in the communication strategy" = c(
                              
                             "Start of the publication of monetary policy decision bulletins.",
                             
                             "The publication of Quarterly reports is established, accompanied by a presentation and a press conference.",
                           
                           "Formal adoption of an Inflation Targeting Regime.", 
                           
                           "The bank sets specific dates for monetary policy decisions.",
                           
                           "At least one bulletin is published at the end of the month and another if the policy changes from one month to the next.", 
                           
                           "Monetary policy decissions decrease from 23 to 12 a year.", 
                           
                           "Monetary policy decissions decrease from 12 to 11 a year.",
                           
                           "*The central bank begins to implement its monetary policy through an operational target for the overnight interbank funding rate.",
                           
                           "Inflation reports include fan charts for inflation and growth forecasts.", 
                           
                           "Start of the publication of the minutes of Board of Directors' meetings.",
                           
                           "Monetary policy decissions decrease from 11 to 8 a year.", 
                                                                            "Video broadcast of the presentation of the Quarterly Inflation Report.", 
                                                               
                           
                           "*Former Governor Agustín Carstens announces the launch of the 'Banxico Educa' website. This site aims to inform and educate the general public about the objectives, goals and duties of Banco de México. It is also intended to be a means of dissemination and education on economic and financial culture for the country.",
                           
                           "The central projection path for inflation and economic activity is included in the fan charts.",
                           
                           "*The central bank shifts its monetary policy strategy to Inflation Forecast Targeting.",
                           
                           "Inflation reports include for the first time point forecasts of annual quarterly inflation.",
                                                                            "The minutes begin to disclose the identity of the voters and, in case of dissent, also incorporate a section explaining the reasons for the dissenters' vote.",
                                                                            "The minutes and monetary policy statements are published simultaneously in Spanish and English on the corresponding date.", 
                                                                            "Announcement that transcripts of the meetings will be made available to the public three years after the meeting.", 
                                                                            "The Board of Directors adopted a Banxico Speakers approach, making available transcripts of speeches and public presentations by the members.", 
                           
                           "The General Communication Criteria for the Board of Directors and Banxico's staff are updated and made public for the first time.",
                                                                            "It is established that the press releases, monetary policy statements and minutes would be made clearer and more concise in its extension.", 
                                                                            "First disclosure of transcripts.",
                                                                            "An update of headline and core inflation forecasts for the following eight quarters is published after each monetary policy decision.",
                                                                            "The monetray policy statements identify the direction of the vote of each of the members of the Board of Directors who participated in said meeting, indicating the members who adopted the decision taken and, if applicable, those who voted for an alternative decision and what it consisted of.", 
                                                                            "*Forward guidance is included in monetary policy statements."))

A<-knitr::kable(Banxico_Communication,
             caption = "Evolution of Banco de México's communication strategy",
             booktabs = T,
             longtable = F,
             col.names = c("Year",
                           "Advances in the communication strategy"))  %>%
  kable_paper(font_size = 10 ,latex_options = c("hold_position"),
                full_width = T) %>%
  collapse_rows(columns = 1, latex_hline = "major", valign = "middle",
                row_group_label_position = "identity") %>%
  column_spec(1, width = "1cm", bold = T) %>%
  #kableExtra::kable_paper() %>%
  #landscape() %>%
  add_footnote(c("Source: Banxico's official documents and press releases from the Boards of Directors.", "Note: (*)  observations added other than those officially accepted by Banxico."),
               notation = "none", threeparttable = F)
A
```


Elements removed from the documents are:

-   **Monetary Policy Statements**:
    -   Headers and footers, titles and captions, dates, footnotes, page numbers and forecast table.
-   **Minutes**:
    -   Headers and footers, titles and subtitles, footnotes, page numbers, charts and tables and the material presented by the Economic Research and Central Bank Operations Departments.
-   **Quarterly Inflation Reports**:
    -   Front and back covers, headers and footers, disclaimers, table of contents, titles and captions, subtitles, footnotes, page numbers, charts and tables, boxes, appendices and technical chapters.
    
In the sample there are 48 Quarterly Inflation Reports (4 per year), 96 Monetary Policy Minutes (8 per year) and 98 Monetary Policy Statements (8 per year and 2 extemporaneous decisions).

# 4. Linguistic analysis of Banco de México's publications

With the latter in mind, it is possible to evaluate the clarity of the information delivered by the central banks using the reading ease tests. The purpose of these tests is to study the ease or difficulty of reading a specific text, i.e. to assess the readability of a document in terms of its clarity and accessibility to a wide audience.

The literature on readability formulas emerged at the end of the 19th century in the United States, when academics were looking for methods to evaluate the vocabulary and comprehension level of scientific texts used in high school and higher education. Although many researchers have been credited with the development of readability measures, the literature considers that Rudolph Flesch was the first to propose a versatile formula for analyzing the readability of texts written in English.[^24]

[^24]: See @fleschEstimatingComprehensionDifficulty1943[-@fleschArtReadableWriting1949].

Following Flesch's research, many other formulas have been developed for analyzing the readability of a document. Like Flesch formula, the majority of these measures suppose that the larger the sentences and the more syllables per word, the more difficult it is to understand and read a text. Therefore, they construct their scores by using the average word length and sentences to asses is a text is easy or difficult to read. For example, the computation of Flesch test gives a score between 1 and 100, with 100 being the highest readability score. Another useful measures are the Flesch-Kincaid and the Gunning Fog scores, both yielding in a numeric measures as the US grade level generally required to understand the text.[^25]

[^25]: See @gunningTechniqueClearWriting1952 and @kincaidDerivationNewReadability1975.

These formulas, among others, are widely used to analyze the readability of English texts. Specially they are widely implemented for text analysis in fields such as medicine, psychology, education, and political science. Recently, there is a growing literature applying traditional and brand new measures of readability in the field of economics, and specifically in monetary policy trying to measure the clarity of central bank communication conveyed by official documents and speeches of officials, transcripts of interviews, and even central banking news in journals and magazines related to business and finance.

However, it is not possible to analyze printed texts in Spanish with these methodologies. In the search for the adaptation of these formulas to the texts written in Spanish, José Fernández Huerta [-@fernandezhuertaMedidasSencillasLecturabilidad1959] developed a first measure to test the readability of a wide variety of Spanish documents. Later on, @gutierrezdepoliniInvestigacionSobreLectura1972, @szigrisztpazosSistemasPredictivosLegilibilidad1992, @munozbaquedanoLegibilidadVariabilidadTextos2006, @barriocantalejoMedicionLegibilidadTextos2003 and @barriocantalejoValidacionEscalaINFLESZ2008 expanded the readability and perspicuity literature disposable for Spanish printed text.

The intuition behind these formulas is the same as Flesch's: the longer the sentences and the more syllables per word, the more difficult it is to understand and read a text. Moreover, the selection of one or the other is quite arbitrary because they are highly correlated. For the purposes of this research, the scores of Fernández Huerta (FH), Szigriszt Pazos (SZ) and Barrio Cantalejo *et al*. (FSZ, INFLEZS scale) were calculated. The formal presentation of the formulas can be found in Appendix A. Table 2 shows the most common scales for interpreting Spanish written texts.


```{r Table 2 Readability and Perspicuity Scales, echo=FALSE, message=FALSE, warning=FALSE, paged.print=TRUE}
FLESCH.SCALE <- data.frame("Score" = c(100,95,90,85,80,75,70,65,60,55,50,
                                       45,40,35,30,15,0),
                           
                           
                           "INFLESZ" = c(rep("Very easy",4), rep("Fairly easy",3),
                                         rep("Standard",2), rep("Fairly difficult",3),
                                         rep("Very difficult",5)),
                           
                           "Readability Mu" = c(rep("Very easy",2), rep("Easy", 2),
                                           rep("Fairly easy",2),rep("Standard",2), 
                                           rep("Fairly difficult",2), 
                                        rep("Difficult",4), rep("Very difficult",3)),
                           
                           "Szigriszt" = c(rep("Very easy",3), rep("Easy", 2),
                                           rep("Fairly easy",2),rep("Standard",3), 
                                           rep("Fairly difficult",3), 
                                           rep("Difficult",2), 
                                           rep("Very difficult",2)),
                           
                           "Fernández Huerta" =c(rep("Very easy",2), rep("Easy", 2),
                                           rep("Fairly easy",2),rep("Standard",2), 
                                           rep("Fairly difficult",2), 
                                        rep("Difficult",4), rep("Very difficult",3)))

color_INFLESZ = c(rep("#F7FBFF",5),rep("#C6DBEF",3),rep("#9ECAE1",2),
                  rep("#6BAED6",3),rep("#2171B5",4))
color_INFLESZ = rev(color_INFLESZ)

color_FSZ = c(rep("#F7FBFF",2),rep("#DEEBF7",2),rep("#C6DBEF",3),
              rep("#9ECAE1",3),rep("#6BAED6",2),rep("#4292C6",2),
              rep("#2171B5",3))
color_FSZ = rev(color_FSZ)

color_FH = c(rep("#F7FBFF",3),rep("#DEEBF7",4),rep("#C6DBEF",2),
              rep("#9ECAE1",2),rep("#6BAED6",2),rep("#4292C6",2),
              rep("#2171B5",2))
color_FH = rev(color_FH)

color_F = c(rep("#F7FBFF",3),rep("#DEEBF7",4),rep("#C6DBEF",2),
              rep("#9ECAE1",2),rep("#6BAED6",2),rep("#4292C6",2),
              rep("#2171B5",2))
color_F = rev(color_F)

knitr::kable(FLESCH.SCALE,
             caption = "Readability and Perspicuity Scales",
             align = "c",
             booktabs = T,
                 col.names = c("Score","INFLESZ(Flesch-Szigritz)",
                               "Readability Mu",
                               "Szigriszt",
                               "Fernández Huerta"))  %>%
  kable_styling(latex_options = c("hold_position"),
                full_width = F) %>%
  collapse_rows(columns = 2:5, latex_hline = "major", valign = "middle",
                row_group_label_position = "identity") %>%
  column_spec(2, background = color_INFLESZ,
              color = "black", width = "3cm",bold = T) %>%
  column_spec(4, background = color_FSZ,
              color = "black",width = "3cm",bold = T) %>%
    column_spec(5, background = color_FH,
              color = "black",width = "3cm",bold = T) %>%
  column_spec(3, background = color_F,
              color = "black", width = "3cm",bold = T) %>%
  add_footnote("Source: Fernández Huerta (1959), Szigriszt-Pazos (1992), Muñoz (2006) 
               and Barrio Cantalejo et al. (2008).",
               notation = "none")
```



```{r Table 3 Word Count - Descriptive Statics, echo=FALSE, message=FALSE, warning=FALSE}
A<- Banxico_readability %>%
  mutate(words = as.numeric(words),
         sent = as.numeric(sentences))%>%
  select("Year", "document", "words", "sent") %>%
  pivot_longer(cols = c(`sent`,words),
               names_to = "Count", 
               values_to = "Count_vals") %>%
  group_by(document,Count) %>%
  summarise(n = length(document),
            mean = round(mean(Count_vals),2),
            median = round(median(Count_vals),2),
            sd = round(sd(Count_vals),2),
            min = min(Count_vals),
            max = max(Count_vals))

# rearrange
A <- A[,c(1,3,2,4:8)]

#max min dates
MM<- Banxico_readability %>%
 filter(document == "MPM") %>% #minutes
 mutate(D <- format(dates, format = "%m-%y"))

IQR<- Banxico_readability %>%
    filter(document == "QIR")%>% #reports
    mutate(D <- format(dates, format = "%m-%y"))

MPS<- Banxico_readability %>%
    filter(document == "MPS") %>% # statements
    mutate(D <- format(dates, format = "%m-%y"))

#MIN DATE
A$mindate <- c(MM$D[which.min(MM$sentences)],MM$D[which.min(MM$words)],
               MPS$D[which.min(MPS$sentences)],MPS$D[which.min(MPS$words)],
               IQR$D[which.min(IQR$sentences)],IQR$D[which.min(IQR$words)])
#MAX DATE
A$maxdate <- c(MM$D[which.max(MM$sentences)],MM$D[which.max(MM$words)],
               MPS$D[which.max(MPS$sentences)],MPS$D[which.max(MPS$words)],
               IQR$D[which.max(IQR$sentences)],IQR$D[which.max(IQR$words)])
A <- A[,c(1:7,9,8,10)]

#Banxico_readability %>%
 # mutate(words = as.numeric(words))%>%
  #select("dates", "Year", "document", "words") %>%
  #filter(Year == 2020 & document == "MPD")

knitr::kable(A,
             caption = "Word Count- Descriptive Statics",
             align = "c",
             booktabs = T,
             col.names = c("Document","No.", "Count",
                           "Mean","Median","SD",
                "Min.", "Min. Date",
                "Max.", "Max. Date")) %>%
      kable_styling(latex_options = c("hold_position"),
                  full_width = T) %>%
    collapse_rows(columns = c(1,2), latex_hline = "major", valign = "middle",
                row_group_label_position = "identity") %>%
    add_footnote(c("Source: Author's calculation."),
                 notation = "none")
rm(A,MM,MPS,IQR)
```


Table 3 displays the basic descriptive statistics of the word and sentence count. On average, MPSs have the shortest extension, 1,101 and 37 words and sentences respectively, and QIRs the largest extension, 17,546 and 548. The MPMs find in between with an average count of 6,148 words and 178 sentences.


\noindent
```{r Figure 1 Banco de México official publications Word count, echo=FALSE, message=FALSE, warning=FALSE}

library(latex2exp)
library(ggtext)
library(ggthemes)
library(paletteer)

#install.packages("devtools")
#devtools::install_github("jaredhuling/jcolors")
#library(jcolors)

#vintage <- c("#1c1f4c","#00848c","#037272","#fccf17","#fec20f","#edebd9")
#winter <- c("#f0ac49","#0c2738","#9a062b","#f64440","#dfa650","#041520")
Banxico_readability <- Banxico_readability
Figure1 <- Banxico_readability %>%
  mutate(words = as.numeric(words), # convert words into numeric variable
         "Year" = format(dates, format = "%Y")) %>% # year variable
  select(dates,document,words,Year) # select specific variables

Figure1 %>%
  ggplot(aes(x= dates, # aesthetics
             y= words,
             color= document)) +
  geom_point(# dot plot
             size = 1)+
  geom_line(aes(x= dates, # line plot
                y= words,
                group = 1.5),
            size = 0.5)+
  #labels of the Figure
  labs(title = "",
        x = "",
        y = "No. Words",
    color = " ",
      caption = "**Figure 1**: Banco de México official publications: Word count.<br><br>Source: Author's calculation.")+
    theme_tufte(base_family = "serif",
            base_size = 11)+
  #scale_color_brewer(palette="Set1")+
  #scale_color_manual(values = winter)+
  #scale_color_wsj()+
  #scale_color_economist()+
  scale_color_manual(values =  paletteer_d("tidyquant::tq_green"))+
  theme(legend.position = "none",
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        strip.text.y = element_markdown(hjust = 0,
                                        size = 11, 
                                        face = "bold"))+
  scale_x_date(date_breaks = "2 year", # change x-axis breaks and format
               date_labels = "%Y") +
  # split the figure using the type of document
  facet_grid(
             rows =vars(document),
             shrink = T, scales = "free_y")

```

If we look at the information provided in Figure 1, it is quite evident that the length of publications has changed over time. From 2011 to mid 2019 there is a clear tendency toward increase the total number of words in each publication. However, the distribution of the MPSs has an atypical observation in February 2016. The extension of the statement release on 17 February 2016 might be explained because it was an extemporaneous decision due to turbulence in the international markets that affected the exchange rate and could increase the likelihood of inflation expectations that was not consistent with Banco de México's inflation target of 3%.[^27] The second extemporaneous decision occurred in April 2020 due to economic disruptions resulting from the COVID-19 pandemic, although the word count was close to the usual length.

[^27]: See [Banco de México, 17 de febrero de 2016, Anuncio de Poítica Monetaria](https://www.banxico.org.mx/publicaciones-y-prensa/anuncios-de-las-decisiones-de-politica-monetaria/%7B394FBB23-9099-AAB2-6B9B-2FDBAEEE5710%7D.pdf)

Another important highlight of this period is that from the start of 2020, both the minutes and statements experienced a change characterized by a decrease in word count, while inflation reports began to contain, on average, a higher number of words than in previous years. For instance, before 2020, MPSs and QIRs contained an average of 1,223 and 15,546 words, respectively. In the latter period, these averages dropped to 745 in the case of the MPSs, and rose to 23,547 in the QIRs. The minutes on the other hand, despite the shift occurred on February 2020, presented a higher average between 2020 and 2022 (7,513 vs 5,668). 

The changes on the average extension of the publications is aligned with 2 major events, the updated on Banxico's communication criteria and the COVID-19 pandemic. Thus, in spite of the promise to make shorter in extension the minutes, it is possible that the increase in the average word count responded to better and greater deliberation process during the pandemic, its aftermath, the surge on inflation in mid 2021, and the needed to manage expectations while the macroeconomic and financial conditions remained highly volatile.


```{r Partial averages, eval=FALSE, include=FALSE}
Banxico_readability <- Banxico_readability %>%
  mutate(words = as.numeric(words))

A <- Banxico_readability%>%
  select("Year", "document", "words") %>%
  group_by(document) %>%
  filter(Year %in% 2011:2019) %>%
  summarise(n = length(document),
            mean = mean(words),
            median = median(words),
            sd = sd(words),
            min = min(words),
            max = max(words))
B <-Banxico_readability%>%
  select("Year", "document", "words") %>%
  group_by(document) %>%
  filter(Year %in% 2020:2022) %>%
  summarise(n = length(document),
            mean = mean(words),
            median = median(words),
            sd = sd(words),
            min = min(words),
            max = max(words))
#round(A$mean[2])
#round(A$mean[1])
```



For its part, Banco de México's communication over time shows an upward trend in readability and perspicuity levels. The quarterly reports consistently have clarity levels between 46 and 57, which are considered difficult and fairly difficult to read and understand according to the Szigritzs and INFLESZ scales. 

Minutes and statements, on the other hand, show a gradual tendency towards a standard level of readability and perspicuity, equivalent to a junior high grade level in the Szigritzs and INFLESZ scales respectively. Figure 2 illustrates these trends in the clarity of Banco de México over time, which suggest that the central bank's communication has become more accessible and easier to read.


\noindent
```{r Figure 2 Readability of Banco de México Over Time, echo=FALSE, fig.height=5, message=FALSE, warning=FALSE}

#library(gridExtra)
#library(ggpmisc)
#load("data.RData")
#library(pals)

#vintage <- c("#1c1f4c","#00848c","#037272","#fccf17","#fec20f","#edebd9")

A<- Banxico_readability %>%
  dplyr::mutate("Year" = format(dates, 
                                format="%Y"),
                "FH" = `Fernandez Huerta`,
                "FSZ" = `Flesch-Szigriszt`,
                "MU" = Readability_MU,
                "SZ"= Szigriszt,
                "Avg" = (FH + FSZ + SZ)/3 ,
                "Harry Potter" = 80) %>%
  dplyr::filter(Year %in% 2011:2022) %>%
  pivot_longer(cols = c(FH,FSZ,
                         SZ,`Avg`,
                        `Harry Potter`),                                    
                            names_to = "Flesch", 
                            values_to = "Flesch_index")
colorF2 <- c("#0055AA","#C40003","#FF7F00","#00C19B","#EAC862")
A%>%
  filter(Year %in% 2011:2022) %>%
  ggplot(aes(x= dates,
             y= Flesch_index,
             color = Flesch,
             group = Flesch)) +
  geom_line(size = 0.7)+
    labs(
    #title = "",
    #subtitle = "",
    x = " ",
    y = " ",
    color = " ",
    caption = "**Figure 2**: Readability of Banco de México over time.<br><br>Source: Author's calculation.<br>Note: The average was calculated using the standard mean at each time position of the three readability<br>measures. Dashed lines correspond to the level of readability on the INFLESZ scale.  Harry Potter<br>denotes the minimum score of the famous novel *Harry Potter and the Philosopher's Stone*.")+
  theme_tufte(base_family = "serif",
            base_size = 11)+
  #scale_color_brewer(palette="Set1")+
  #scale_color_manual(values = wes_palette("Darjeeling1"))+
  #scale_color_uchicago()+
  #scale_color_futurama()+ # ggsci palette
  #scale_color_manual(values = pals::stepped())+ # pal library 
  #scale_color_manual(values = winter)+
  #scale_color_wsj()+
  scale_color_manual(values = colorF2)+
  #scale_color_manual(values =  paletteer_c("ggthemes::Red-Green-White Diverging", 30))+
  #scale_color_manual(values = paletteer_d("wesanderson::Darjeeling1"))+
  #scale_color_economist()+
  scale_x_date(date_breaks = "3 year",
               date_labels = "%Y")+
  scale_y_continuous(name="INFLESZ Scale",
               sec.axis = sec_axis(~.*1, name = "INFLESZ Scale"))+
  theme(legend.position = "bottom",
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot") +
  facet_grid(
             cols = vars(document),
             shrink = T, scales = "free_x") +
  geom_hline(yintercept = 40, color = "#DEEBF7", 
             linetype = "dashed", size = 0.8) +
  geom_hline(yintercept = 55, color = "#C6DBEF",
             linetype = "dashed", size = 0.8) +
  geom_hline(yintercept = 65 , color = "#9ECAE1",
             linetype = "dashed", size =0.8)
rm(A)
```


Despite these recent advances in the readability of the central bank, the documents are, on average, at a fairly difficult-to-read level according to most of the scales, i.e., Banco de México's communication might be better understood by people with at least a high school education, or who can easily interpret documents such as scientific dissemination articles or specialized press publications (See Table 4).

In addition, the scores are well below the minimum level for Spanish-language measures of the fantasy novel written by J. K. Rowling, *Harry Potter and the Philosopher's Stone*, which is considered very easy to read and interpret. This is relevant, mainly because the National Institute of Statistics and Geography (INEGI) reports, in the 2020 Population and Housing Census, that more than 50 percent of the population has only basic education (elementary and junior high) or no schooling, and the average years of schooling have remained at levels equivalent to junior high education (See Figure 3). Therefore, the scope of Banxico´s publications still lag of clarity for a vast majority of the population.



```{r Table 4 Average readability of Banco de Méxicos publications, echo=FALSE, fig.height=4.5, fig.width=6, message=FALSE, warning=FALSE}

A<- Banxico_readability %>%
  select(dates,document,statement,`Flesch-Szigriszt`,
         `Flesch-Szigriszt grade`,`Fernandez Huerta`,
         `Flesch-Szigriszt grade`,Gutierrez,
         Szigriszt, Readability_MU, Year) %>%
  mutate(FSZ = `Flesch-Szigriszt`,
         FH = `Fernandez Huerta`,
         Gut = Gutierrez,
         SZ = Szigriszt,
         Mu = Readability_MU,
         "sf" = max(`Flesch-Szigriszt`)/max(Gutierrez),
         "Avg" = (`Fernandez Huerta` + `Flesch-Szigriszt`+ Gutierrez)/3) %>%
  pivot_longer(cols = c(FH,FSZ,SZ,Mu),                                    
                            names_to = "Flesch", 
                            values_to = "Flesch_index") %>%
    group_by(document, Flesch) %>%
    summarise(average = mean(Flesch_index))
#A <- as.data.frame(t(A))

A$scale <- c("Fairly difficult", "Fairly difficult","Difficult","Fairly difficult",
             
             "Fairly difficult","Fairly difficult","Difficult","Fairly difficult",
             
             "Fairly difficult","Fairly difficult","Difficult","Fairly difficult")

A$grade <- c("High School", "High School", "-", "High School",
             
             "High School", "High School", "-", "High School",
             
             "High School", "High School", "-", "High School")

A$type <- c("-","Dissemination","-","Quality Magazine",
            
            "-","Dissemination","-","Quality Magazine",
            
            "-","Dissemination","-","Quality Magazine")



#color of the scale column
color= c(rep("#C6DBEF",2),rep("#DEEBF7",1),rep("#C6DBEF",3),
        rep("#DEEBF7",1),rep("#C6DBEF",3),
        rep("#DEEBF7",1),rep("#C6DBEF",1))

knitr::kable(A,
             caption = "Average readability of Banco de México's publications",
             align = "c",
             booktabs = T,
  col.names = c("Test","Document","Average" ,"Scale","Grade Level", "Type")) %>%
      kable_styling(latex_options = c("hold_position"),
                  full_width = F, font_size = 11) %>%
    collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle") %>%
    column_spec(3, background = color,
              color = "black",bold = T) %>%
      column_spec(4, background = color,
              color = "black",bold = T)  %>%
    add_footnote(c("Source: Author's calculation."),
                 notation = "none",
                 threeparttable = F)
rm(color)

```



\noindent
```{r Figure 3 Population educ, echo=FALSE, message=FALSE, warning=FALSE}

library(scales)
library(egg)
library(latex2exp)
library(ggtext)
library(ggthemes)
library(paletteer)
library(ggrepel)

#set.seed(1234)
#reds <- colorRampPalette(c("#FF6A6A", "#FF3030","#FF4040","#FF0000","#FF6347"))(33)
#DATA https://www.inegi.org.mx/temas/educacion/

#wsj_pgrade <- c("#C72E29","#016392","#BE9C2E","#098154","#FFDB58","#34495E")

CENSUS_EDUC_LEV <- data.frame(level = c("No schooling","Basic",
                                "Upper middle", "Superior", "Not specified"),
                              percent = c(0.049,0.493,0.240,0.216,0.002))



piechart <- CENSUS_EDUC_LEV  %>%
  #arrange(desc(percent)) %>%
  mutate(csum = rev(cumsum(rev(percent))), 
         pos = percent/2 + lead(csum, 1),
         pos = if_else(is.na(pos), percent/2, pos)) %>%
  ggplot(aes(x="",y= percent, fill = fct_inorder(level))) +
    geom_bar(stat = "identity", color = "#363636", width = 0.5)+
    coord_polar(theta = "y") +
    labs(
    title = " ",
    subtitle = "**Educational level | 2020**<br>",
    x = "",
    y = "",
    color = "",
    fill = ""
    )+
  theme_tufte(base_family = "serif",
              base_size = 11)+
  #scale_fill_wsj()+
  #scale_fill_economist()+
  #scale_fill_manual(values = winter)+
  #scale_fill_economist()+
  scale_fill_manual(values = paletteer_d("tidyquant::tq_dark"))+
  theme(legend.position = "right",
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        #plot.title.position = element_text(hjust = 0),
        plot.caption.position = "plot",
        axis.text.x=element_blank(),
        complete = F,
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 12))+
  geom_label_repel(aes(y = pos, label = paste0(percent*100, "%")),
                   size = c(3,3,3,3,2), nudge_x = 0.5,
                   #nudge_y = 0.5,
                   show.legend = F, family = "serif",
                   color = "white", segment.colour=NA)
 #geom_text(aes(label = scales::percent(round(percent,2))), 
  #          position = position_stack(vjust = 0.5),
   #        show.legend = F, size =c(2.5,4,4,4,4),
    #       family = "serif",
     #      check_overlap = T, color = "white")


#
#library(plotly)

#fig <- plot_ly(CENSUS_EDUC_LEV, labels = ~level, values = ~percent, type = 'pie')
#fig <- fig %>% layout(title = '',
 #        xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
  #       yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))



#AVERAGE EDUC LEVEL

#https://www.inegi.org.mx/app/tabulados/interactivos/?pxq=Educacion_Educacion_
#05_2f6d2a08-babc-442f-b4e0-25f7d324dfe0

#library(openxlsx)
#educlevel <- openxlsx::read.xlsx("educlevel.xlsx")
#educlevel <- educlevel %>%
 # pivot_longer(cols = c(3), 
  #             values_to = "vals",
   #            names_to = "names")


#colors <- rainbow(length(unique(1:33)))
#set.seed(1234)
#reds <- colorRampPalette(c("#FF6A6A", "#FF3030","#FF4040","#FF0000","#FF6347"))(33)
#reds[19] <- "#00B2EE"
#educlevelplot <- educlevel %>%
#  group_by(names) %>%
#  arrange(desc(State)) %>%
#  ggplot(aes(x= reorder(State, vals), y=vals, fill = factor(State))) +
#  geom_col(position="dodge", stat = "identity",width = 0.6,
#           color = "#363636")+
  #coord_flip()+
#  labs(title = " ",
#    subtitle = "**Average schooling**",
#         y = "Years of schooling",
#         x = "",
#      caption = "**Figure 3**: Population over 15 years old.<br><br>Source: INEGI.<br>Note: Basic = Elementary and Junior high; Upper middle = High School;<br>Superior = University and Graduate.") +
#    theme_tufte(base_family = "serif",
#            base_size = 11)+
    #scale_color_brewer(palette="Set1") +
    #scale_color_manual(values = vintage)+
  #scale_color_wsj()+
  #scale_fill_wsj(palette = rep("colors6",6))+
  #scale_color_economist()+
#  scale_fill_manual(values = reds)+
#      theme(legend.position = "none",
#               plot.caption = element_markdown(hjust = 0,
#                                        size = 11),
#        plot.caption.position = "plot",
#        plot.subtitle = element_markdown(hjust = 0,
#                                        size = 12),
#        axis.text.x = element_text(angle = 45)
#        )

    #  facet_grid(
     #        rows = vars(Ling),
      #       shrink = T, scales = "free")




## 

# EDUC LEVEL OVER TIME

##

educ_level <- data.frame(Year = c(2010,2015,2020),
                         avg = c(8.63, 9.16, 9.74))

educlevelplot <- educ_level %>%
  ggplot(aes(x= factor(Year), y=avg, fill = factor(Year))) +
  geom_col(position="dodge", stat = "identity",
           width = 0.5,
           color = "#363636")+
  #coord_flip()+
  labs(title = " ",
    subtitle = "**Average years of schooling**",
         y = "Years of schooling",
         x = "",
      caption = "**Figure 3**: Population over 15 years old.<br><br>Source: INEGI.<br>Note: Basic = elementary and junior high; Upper middle = high School;<br>Superior = university and graduate.") +
    theme_tufte(base_family = "serif",
            base_size = 11)+
    #scale_color_brewer(palette="Set1") +
    #scale_color_manual(values = vintage)+
  #scale_color_wsj()+
  #scale_fill_wsj()+
  scale_fill_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  #scale_color_economist()+
#  scale_fill_manual(values = reds)+
      theme(legend.position = "none",
               plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 12)
        #axis.text.x = element_text(angle = 45)
        )+
   geom_text(aes(label = avg), size = 4, hjust = 0.5, vjust = 3, 
             position = "dodge",
             family = "serif",
           check_overlap = T, color = "white")




#piechart
#educlevelplot


multiplot(educlevelplot,piechart, cols = 2)
    
```


However, this approach to central bank readability should be interpreted as informative and not as a recommendation to change the central bank's writing style. These traditional readability scores help to interpret the results with the readability of a wide audience in mind. And although central banks should try to make their communication accessible to a broad spectrum of people, often such documents are only used by decision-makers, market participants or people with a high technical background, who can easily understand the central bank's message.

Another reason to be very cautious with traditional readability measures is that they punish with lower scores the more complex the words and the longer the sentences. However, in fields such as economics, there are many complex words that are easy to understand, and in some cases, longer sentences can provide a clear message about the information the central bank wants to convey.[^20] Joan Huang and John Simon also emphasize that better readability does not mean the central bank is successfully explaining its actions and the motivation behind them.[^21] The reason is that while a comprehensive explanation may not be simple or easily understood, a simple explanation may not be accurate.


[^20]: @wrayExploringReadabilityAssessment2013

[^21]: Huang and Simon (2021).


That said, the reality is that there has been an upward trend in the quantity and quality of the information Banco de México communicates. In addition, the [Pearson] correlation between the linguistic variables yields significant information (See Appendix B). The readability scores within each of the documents are highly correlated. This is because all the formulas use similar variables and parameters, thus the information in each of them is a linear combination of the others. Similarly, word and sentence count have a correlation of about 1 (MPS [0.9], MPM [0.9], QIR [1]). It is understandable that word length and sentence length also follow the same pattern.

The most interesting relationships are those between the word and sentence counts and the readability scores (See Figure 4). While there is a negatively weakened relationship between these variables in the QIRs, MPSs and MPMs reflect very different patterns. In the former, word count correlates highly negatively with the readability scores and sentence count displays a weaker, but still negative relation. On the other hand, Minutes present a strong and positive correlation between sentence count and readability scores, whereas word count has a moderately positive correlation.

Several conclusions can be drawn from this analysis. First, even when inflation reports have increased in length over time, there is little or no relationship with the clarity of their content. It is reasonable to think that this is due to the fact that the reports are long documents with a lot of descriptive information on the economy over the previous quarter, so although they include relevant information for the public, such as central bank's forecasts and balance of risk, their purpose is rather informative and barely include forward guidance elements. Furthermore, the central bank faces the difficult task of summarizing this information, which is not trivial.

Second, there is and inverse (direct) relation between clarity and amount of information in the MPSs (MPMs). This affirmation is especially true post-2020, when Banco de México significantly decrease the amount of information contained in the statements and experienced an increase in their clarity. In turn, the minutes show a direct relationship, pointing out that the longer they are, i.e., the more information there is about the decision-making process, the clearer the communication. Notably, this appears to be due to voter identity disclosure since 2018.


Finally, the high correlation between the readability scores means that, regardless of which one we choose, we will obtain the same results. Therefore, the Flesch-Szigriszt score will be used for further developments.


\noindent
```{r Figure 4 Scatter plots of Ling vars, echo=FALSE, message=FALSE, warning=FALSE}
#install.packages("GGally")
source("multiplot.R")

A<- Banxico_readability %>%
  dplyr::mutate("Year" = format(dates, 
                                format="%Y"),
                "Fernández Huerta" = `Fernandez Huerta`,
                "Flesch-Szigriszt" = `Flesch-Szigriszt`,
                "sf" = max(`Flesch-Szigriszt`)/max(Gutierrez),
              #  "Gutiérrez" = Gutierrez,
                "Gutiérrez" = sf*`Gutierrez`,
                "Avg" = (`Fernandez Huerta` + `Flesch-Szigriszt`+ `Gutiérrez`)/3)

COR_MPM <- A %>%
  select(dates,Year,document,words,sentences,
         `Flesch-Szigriszt`) %>%
  mutate(sentences = as.numeric(sentences),
         words = as.numeric(words)) %>%
    pivot_longer(cols = c(sentences,words),
                            names_to = "Ling", 
                            values_to = "Ling_vals") %>%
    group_by(document) %>%
    filter(document == "MPM") %>%
    ggplot(aes(x = `Flesch-Szigriszt`, y = Ling_vals)) +
    geom_point() +
    geom_smooth(aes(color = Ling),
                method = "lm") +
    labs(title = "",
         subtitle = "**MPM**",
         y = "",
         x = "FSZ score",
         caption = " <br><br> ") +
    theme_tufte(base_family = "serif",
            base_size = 11)+
    #scale_color_brewer(palette="Set1") +
    #scale_color_manual(values = vintage)+
  #scale_color_wsj()+
  scale_color_manual(values = paletteer_d("tidyquant::tq_dark"))+
  #scale_color_economist()+
      theme(legend.position = "none",
                plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 11))+
      facet_grid(
             rows = vars(Ling),
             shrink = T, scales = "free")

COR_MPS <- A %>%
  select(dates,Year,document,words,sentences,
         `Flesch-Szigriszt`) %>%
  mutate(sentences = as.numeric(sentences),
         words = as.numeric(words)) %>%
    pivot_longer(cols = c(sentences,words),
                            names_to = "Ling", 
                            values_to = "Ling_vals") %>%
    group_by(document) %>%
    filter(document == "MPS") %>%
    ggplot(aes(x = `Flesch-Szigriszt`, y = Ling_vals)) +
    geom_point() +
    geom_smooth(aes(color = Ling),
                method = "lm") +
    labs(title = "",
    subtitle = "**MPS**",
         y = "",
         x = "FSZ score",
      caption = "<br>**Figure 4**: Scatter plots of linguistic variables.<br><br>Source: Author's calculation.") +
    theme_tufte(base_family = "serif",
            base_size = 11)+
    #scale_color_brewer(palette="Set1") +
    #scale_color_manual(values = vintage)+
  #scale_color_wsj()+
  scale_color_manual(values = paletteer_d("tidyquant::tq_dark"))+
  #scale_color_economist()+
      theme(legend.position = "none",
                plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 11))+
      facet_grid(
             rows = vars(Ling),
             shrink = T, scales = "free")



COR_QIR <- A %>%
  select(dates,Year,document,words,sentences,
         `Flesch-Szigriszt`) %>%
  mutate(sentences = as.numeric(sentences),
         words = as.numeric(words)) %>%
    pivot_longer(cols = c(sentences,words),
                            names_to = "Ling", 
                            values_to = "Ling_vals") %>%
    group_by(document) %>%
    filter(document == "QIR") %>%
    ggplot(aes(x = `Flesch-Szigriszt`, y = Ling_vals)) +
    geom_point() +
    geom_smooth(aes(color = Ling),
        method = "lm") +
    labs(title = "",
    subtitle = "**QIR**",
         y = "",
         x = "FSZ score",
    color ="",
    caption = " <br><br> ") +
    theme_tufte(base_family = "serif",
            base_size = 11)+
    #scale_color_brewer(palette="Set1") +
  #scale_color_manual(values = vintage)+
  #scale_color_wsj()+
  scale_color_manual(values = paletteer_d("tidyquant::tq_dark"))+
  #scale_color_economist()+
      theme(legend.position = "none",
                plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 11))+
      facet_grid(
             rows = vars(Ling),
             shrink = T, scales = "free")



#COR_MPM
#COR_MPS
#COR_QIR

multiplot(COR_MPS,COR_MPM,COR_QIR, cols = 3)
```




# 5. Structural Break Analysis

The evolution of Banco de México's verbal clarity is strongly linked with institution-specific factors. However, it is possible to identify idiosyncratic biases related to the chairman in office[^30]. Figure 5 shows fitted calculations for total perspicuity of Banxico's publications in the tenures of Agustín Carstens (Jan 10-Nov 17), Alejandro Díaz de León (Dec 17- Dec 21), and Victoria Rodríguez (Jan 22-).

[^30]: For exmaple, @bernanke21stCenturyMonetary2022 narrates how the Fed's monetary policy decisions have historically been strongly biased by the figure of the chairman, especially referring to the great persuasive power of Paul Volcker and Alan Greenspan over the decisions of the other members of the Federal Open Market Committee (FOMC).


\noindent
```{r Figure 5 Readability of Banco de México. Flesch-Szigriszt Score, echo=FALSE, message=FALSE, warning=FALSE}
library(psych)


#Autumcolors <- c("#b6400e","#012148","#800000", "#b16c45", "#ffeca4")
#Autumcolors2<- c("#fbbdb0","#fdd2c1","#f6c4bd", "#e99b84", "#ee9c81")
#branded_colors <- list( "#00798c","#d1495b","#edae49","#66a182","#2e4057","#8d96a3")


#colorF5 <- c("#0055AA","#007ED3","#7FD2FF")
colorF5 <- c("#174D79","#007ED3","#7FD2FF")
A<- Banxico_readability %>%
  dplyr::mutate("Year" = format(dates, 
                                format="%Y"),
                "Fernández Huerta" = `Fernandez Huerta`,
                "FSZ" = `Flesch-Szigriszt`,
                "sf" = max(`Flesch-Szigriszt`)/max(Gutierrez),
              #  "Gutiérrez" = Gutierrez,
                "Gutiérrez" = sf*`Gutierrez`,
                "Avg" = (`Fernandez Huerta` + `Flesch-Szigriszt`+ `Gutiérrez`)/3) %>%
  dplyr::filter(Year %in% 2011:2022)

COR <- A %>%
  select(dates,Year,document,words,sentences,
         FSZ) %>%
  mutate(sentences = as.numeric(sentences),
         Governor = NA)

COR$Governor[COR$Year %in% 2011:2017] = "Agustín Carstens"
COR$Governor[c(140,141)] = "Alejandro Díaz de León"
COR$Governor[COR$Year %in% 2018:2021] = "Alejandro Díaz de León"
COR$Governor[COR$Year %in%2022] = "Victoria Rodríguez"


#COR<-cor(COR[,4:9])

#corrplot::corrplot(COR,
                  # method = "square")
#heatmap(COR)
#str(COR)

COR %>%
  group_by(document, Governor) %>%
  ggplot(aes(y=FSZ,x=dates,
             col = Governor)) +
  geom_point() +
  geom_smooth() +
      labs(
    title = "",
    subtitle = "",
    x = "",
    y = "INFLESZ Scale",
    color = " ",
    caption = "**Figure 5**: Perspicuity of Banco de México.<br><br>Source: Author's calculation.<br>Note: Smoothing data using local regression techniques.")+
  theme_tufte(base_family = "serif",
            base_size = 11)+
  #scale_color_manual(values = vintage)+
  #scale_color_brewer(palette="Roma")+
  #scale_color_wsj()+
  #scale_color_manual(values = paletteer_d("tidyquant::tq_dark"))+
  #scale_color_manual(values = paletteer_d("tidyquant::tq_green"))+
  scale_color_manual(values = colorF5)+
  #scale_color_economist()+
  scale_x_date(date_breaks = "2 year",
               date_labels = "%Y")+
  theme(legend.position = "bottom",
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot") 
  #facet_grid(
   #          cols = vars(document),
    #         shrink = T, scales = "free_x") +
  #geom_hline(yintercept = 40, color = "#e3342f", 
    #         linetype = "dashed", size = 0.3) +
  #geom_hline(yintercept = 55, color = "#f6993f",
   #          linetype = "dashed", size = 0.3) +
  #geom_hline(yintercept = 65 , color = "#00b159",
   #          linetype = "dashed", size = 0.3)

```


Despite significant progress during Carstens' tenure, on average, document clarity follows a slightly negative slope. From Díaz de León's term onwards, clarity lifts off and adopts a positive trend towards higher levels. It is possible that Governor Diaz de Leon brought new and improved communication policies, however, these changes in clarity levels seem to be aligned with the shift to an Inflation Forecast Targeting scheme and the update in communication criteria.  In addition, during Díaz de León's tenure, Banxico's publications underwent an important modification in their structure, which is not entirely the result of Díaz de León but of Banxico's staff. On the other hand, since Victoria Rodriguez took office, clarity levels have consistently remained below the trend observed in the previous period.

This information, together with the facts reviewed in the previous section, leads us to consider that the levels of clarity have suffered possible structural breaks in the period between 2011 and 2022. To test this hypothesis in the series of perspicuity for every document, unit root tests that allow for one and two endogenous breaks will be perform. 

First of all, as the MPSs and MPMs observations are not collected on a regular monthly frequency, the imputation technique Last Observation Carried Forward (LOCF) was implemented. The latter follows the rationale that if the central bank coveys communication in month 1 and the next release is not until month 3, the communication given in month 1 still has effect in the later period until the next communication.

In the case of the minutes, two exceptions to the dating rule have been made. In December 2016 and May 2020, we have two observations, each at the beginning and end of the month. Subsequent observations were carried forward to fill in the following month. For the statements, there are two releases in February 2016. In this case, instead of carried forward the second observation, January 2016 was filled with the average. Finally, to remove noise from the imputed series, a 5-window centered moving average was applied. The information of the QIRs needs no further manipulation.


For the clarity levels of the three publications, classic unit root tests such as the Augmented Dicky-Fuller (ADF)(Dicky and Fuller, [-@dickeyLikelihoodRatioStatistics1981]), Phillips-Perron (PP)(Phillips and Perron, [-@phillipsTestingUnitRoot1988]) and KPSS (Kwiatkowski et al., [-@kwiatkowskiTestingNullHypothesis1992]) are executed to validate the hypothesis of sationarity in the Data Generating Process (DGP) of the series. The unit root specification includes models with no drift no trend (type A), drift and no trend (type B), and drift with trend (type C) respectively. Overall, there is no convincing evidence against the unit root null-hypothesis (See Appendix C). However, for each series, the KPPS test gives mix evidence on non-stationarity process.

Since the seminal paper by @perronGreatCrashOil1989, the literature has stressed that in the presence of one or more structural breaks, the non-rejection of the unit root null may be biased. Perron's test is a variation of the ADF test that takes into account the possibility of a known exogenous structural break in the time series. Perron relied on previous observation of the macroeconomic series studied by @nelsonTrendsRandomWalks1982, arguing then that the latter's conclusion of integrated process might be biased due to the presence of structural changes in the U.S. economy during the years of the "Great Depression" and the 1973 oil price shock.

In subsequent contributions, Zivot and Andrews (ZA)[-@zivotFurtherEvidenceGreat1992], Banerjee, Lumsdaine, and Stock (BLS)[-@banerjeeRecursiveSequentialTests1992], and and Perron and Vogelsang (PV)[-@perronTestingUnitRoot1992; -@phillipsTestingUnitRoot1988], reviewed Perron's conclusion and criticized the exogenous structural break identification. They propose tests that endogenize the selection of breakpoints. Like Perron's, these tests allow for the presence of structural breaks in the level of the series ("crash" model), a change in trend ("changing growth" model), or both. 

For purpose of this paper ZA and PV test are performed. The method for the selection of the type of break as well as the lags for the augmented form models were selected using both information criterion and general to specific approach for a maximum of 12 lags in the case of the monthly series and 8 in the quarterly series. In all models, we looked for the minimum information criterion and statistical significance at 5% for the maximum lag coefficient.

Table 5 shows the results of applying an _innovational outlier model_ break selection for the ZA and PV tests. The later means that we assume a gradual rather than a sudden change (_additive outlier model_) in the DGP of the series. 

In the case of the ZA test, we contrast the null-hypothesis of the presence of a unit root with no breaks, against the alternative hypothesis of a stationary process with one endogenous break. For the PV test, we allow for one break in the unit root null, against the alternative hypothesis of stationarity with one break. The results show for both test, that the MPMs perspicuity can be characterized as an I(1) process with no breaks (ZA) or a potential and significant break in April 2018 (PV). MPSs and QIRs present evidence of stationarity with a potential time break in level and trend respectively. Furthermore, classic unit root test show that both series might be represented as wise-regime stationary process (see appendix C).


```{r Tab 5 URT one break, echo=FALSE, message=FALSE, warning=FALSE}
Onebreak_Unit <- data.frame( var = c(rep("MPM",2), rep("MPS",2), rep("QIR",2)),
                           type = c("crash.", "crash.","crash", "crash", "chg. growth", "chg. growth"),
                           ZA = c("-3.779(6)","-3.779(6)", "-4.875(6)**" , "-4.875(6)**", "-4.7234(0)**", "-4.7234(0)**"),
                           TB1 = c("Aug-13", "Aug-13", "Mar-20", "Mar-20", "Q2-18" , "Q2-18"),
                           PV = c( "-3.080(6)", "-3.080(6)", "-4.486(6)**",  "-4.486(6)**", "-5.392(0)***", "-5.392(0)***"),
                           TB1 = c("Apr-18", "Apr-18", "May-20", "May-20", "Q3-18" , "Q3-18"))

knitr::kable(Onebreak_Unit,
             caption = "Unit Root tests with one endogenous structural break",
             align = "c",
             booktabs = T,
             col.names = c(" ","Model","t-stat" ,"TB1",
                           "t-stat" ,"TB1")) %>%  
    kable_styling(latex_options = c("hold_position"),
                  full_width = T) %>%
    collapse_rows(columns = 1, latex_hline = "major", valign = "middle") %>%
    collapse_rows(columns = 2:6,
                  latex_hline = "major", valign = "middle") %>%

    #column_spec(3, background = color,
     #         color = "black",bold = T) %>%
      #column_spec(4, background = color,
       #       color = "black",bold = T)  %>%
    add_header_above(c(" " = 2, "ZA" = 2, "PV" = 2),
                     bold = T)%>%
    add_footnote(c("Source: Author's calculation.","Note: selected lag length in parentheses.","Rejection of the null at (*)1%, (**)5%, (***)10% level."),
                 notation = "none",
                 threeparttable = F)

```


From an economic perspective, there is no reason to limit the analysis to a single structural change. Moreover, Lumsdaine and Papell (LP)[-@lumsdaineMultipleTrendBreaks1997] showed that allowing for only one point break could biased the results and conclusions of the previous tests. They extended the analysis to allow for two endogenous unknown structural breaks. However, like the ZA test, the LP test does not allow for breaks under the unit root null, therefore, it excludes all other cases to the alternative hypothesis, i.e., the alternative hypothesis implies that there are breaks in the series including the possibility of unit root with breaks.

Then, is arguably that LP test is not the most appropriate for our data. Instead, Lee and Strazicich (LS)[-@leeMinimumLagrangeMultiplier2003], proposed a minimum Lagrange multiplier test, which is more suitable because expands the analysis to allow for two endogenous unknown breakpoints, both under the null and alternative hypothesis. Hence, the model specifications of Ls test is a unit root process with up to two structural breaks in level, trend or both, against the alternative hypothesis of an stationary process with up to two breaks in level, trend or both. 

In addition, the bootstrap procedure proposed by @chouPerformanceLMtypeUnit2007 is implemented to derive the critical values (CVs) of the t-statistics. This methodology is useful because it adjusts the CVs to the specific characteristics of each of the series, rather than assuming asymptomatic properties to be true, and also allows for a detailed analysis of the distributional properties of the t-statistics and possible breakpoints[^31].

[^31]: For a similar implementation of this procedure see @lipsTheyStillMatter2017.


Table 6 shows the results of perform the LS minimum Lagrange multiplier test with up to two endogenous breaks in level and trend. The models were selected using both information criterion and general to specific approach, looking for the minimum information criterion and statistical significance at 5% for the maximum lag coefficient. In the selection of the breaks we control 10% of the data heads and tails to avoid endpoint selection, and the second temporal break is allowed to occur only after two periods of the first. Under the critical values derived by @leeMinimumLagrangeMultiplier2003, all tests display statistical significance at 10% level to stationary processes with two break points. Under the bootstrap derived critical values, we can not reject the unit root with breaks null.


```{r Tab 6 URT two break, echo=FALSE, message=FALSE, warning=FALSE}
Onebreak_Unit <- data.frame( var = c(rep("MPM",2), rep("MPS",2), rep("QIR",2)),
                           #type = c("break", "break","break", "break", "break", "break"),
                           tstat = c("-5.43","-5.43", "-5.47" , "-5.47", "-5.93", "-5.93"),
                           TB1 = c("Jan-15", "[May-12,Feb-16]", "Oct-17", "[Apr-12,Sep-18]", "Q2-15" , "[Q3-13,Q1-19]"),
                           TB2 = c( "Aug-19", "[Dec-14,Jan-21]","Aug-20", "[Sep-23,Mar-21]", "Q3-19", "[Q4-16,Q2-21]"),
                           LS_CV1 = c("-6.33", "-6.33", "-6.32", "-6.32", "-6.42" , "-6.42"),
                           LS_CV5 = c("-5.71", "-5.71", "-5.73", "-5.73", "-5.65" , "-5.65"),
                           LS_CV10 = c("-5.33", "-5.33", "-5.32", "-5.32", "-5.33" , "-5.33"),
                           
                           BTS_CV1 = c("-8.32", "-8.32", "-8.54", "-8.54", "-7.99" , "-7.99"),
                           BTS_CV5 = c("-7.73", "-7.73", "-7.87", "-7.87", "-7.19" , "-7.19"),
                           BTS_CV10 = c("-7.47", "-7.47", "-7.60", "-7.60", "-6.71" , "-6.71")                           )


knitr::kable(Onebreak_Unit,
             caption = "Unit Root tests with two endogenous structural breaks",
             align = "c",
             booktabs = T,
             col.names = c(" ","t-stat" ,"TB1",
                           "TB2" ,"1%", "5%","10%",
                           "1%", "5%","10%")) %>%  
    kable_styling(latex_options = c("hold_position"),
                  full_width = T, font_size = 11) %>%
    collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle") %>%
    collapse_rows(columns = 5:10,
                  latex_hline = "major", valign = "middle") %>%
    column_spec(2,  width = "2cm") %>%
    column_spec(3,  width = "3cm") %>%
    column_spec(4,  width = "3cm") %>%
      #column_spec(4, background = color,
       #       color = "black",bold = T)  %>%
    add_header_above(c(" " = 4, "LS CVs" = 3, "Bootstrap CVs" = 3),
                     bold = T, font_size = 11)%>%
    add_footnote(c("Source: Author's calcultion.","Note: 95% bootstrapped two-sided confidence intervals in squared brackets."),
                 notation = "none",
                 threeparttable = F)

```


Despite the stationary characteristics of the series, I(1) processes under these results, the 95% bootstrap confidence intervals (C.Is) yield significant findings (See Appendix D). For the first time break, the point estimates of MPSs and QIRs do not appear to be statistically significantly different since for both the C.Is overlap quite substantially. Therefore, it is possible that the structural break for each series occurs on the same date. Following the C.Is evidence, it is preferable to assume that the structural change occurred in 2018, in line with the progress in Banxico's communication. In the case of MPMs, the first break is estimated to have occurred in early 2015.


For the second time break, the three C.Is overlap, thus, the points estimates do not appear to be significantly different. Moreover, for the MPSs and QIRs, the intervals include the point estimates of ZA tests, and the time break of the three series for the PV tests. Based on these findings the structural change date is set rather ad-hoc to have occurred between the first and third quarter of 2020.

Figure 6 illustrates the structural breaks in the adjusted monthly series of the minutes and statements, and the quarterly series of inflation reports. As the statistical tests suggest, the visual trajectory of the series shows that all breakpoints appear to be aligned with the intervals selected ah-hoc in advance.

The clarity of the minutes adopts an upward trajectory after the first-time break, going from levels that are fairly difficult to read and understand to standard difficulty on the INFLESZ scale. However, after the second time break, the upward trajectory is interrupted and the series appears to flatten out without even reaching standard clarity levels.

On the other hand, monetary policy statements show, on average, fairly difficult levels of clarity before the first break. Thereafter, the trajectory of the series turns positive. In 2020, when the second time break occurs, the clarity of the statements decreases for a brief period, then starts to increase and reaches a standard difficulty in mid-2021.

Finally, the clarity of quarterly reports seems to have a downward trend before 2018. After the first break, the difficulty of reading starts to gradually decrease. As with monetary policy statements, the upward trajectory is briefly interrupted in 2020 and clarity levels begin to improve from the second quarter of this year. Although, throughout the entire period reading difficulty remains below the standard level.


```{r eval=FALSE, include=FALSE}
#install.packages("devtools")
#devtools::install_github("jaredhuling/jcolors")
#library(jcolors)


#___________________________________

# TRANSFORMATONS

#____________________________________


#TS_data$IQRs <- NA
#IQR$dates = as.Date(format(IQR$dates, format= "%Y-%m-01"))
#for (i in 1:144) {
 #   for (j in 1:48) {
  #      if (TS_data$dates[i] == IQR$dates[j]) {
   #       TS_data$IQRs[i] = IQR$`Flesch-Szigriszt`[j]
    #    }
    #}
#}

#TS_data2 <- TS_data %>%
 #   pivot_longer(cols = c(MPSs.LOCF.,MPMs.LOCF.),
  #               names_to = "LOCF",
   #              values_to = "LOCF_vals") 

#TS_data3 <- TS_data %>%
 #   pivot_longer(cols = c(MPSs.5MA.,MPMs.5MA.,IQRs),
  #               names_to = "MA",
   #              values_to = "MA_vals") %>%
    #mutate(document = substring(MA, first = 1, last = 3))


#TS_data3 <- TS_data3 %>%
  #  mutate("LOCF" = TS_data2$LOCF,
   #      "LOCF_vals" = TS_data2$LOCF_vals) %>%
 #   mutate(document = substring(MA, first = 1, last = 3))




#___________________________________

# MPS graph

#____________________________________


MPSplot <- TS_data3%>%
  filter(document == "MPS") %>%
    ggplot() +
    geom_line(aes(x= dates, # aesthetics
               y= MA_vals),
              color = "#C40003")+
  # ADD TIME BREAK 1
  annotate('rect', xmin=as.Date("2018-01-01"), xmax=as.Date("2018-12-01"), ymin=min(TS_data3$MA_vals[TS_data3$document == "MPS"] ,na.rm = T), ymax=max(TS_data3$MA_vals[TS_data3$document == "MPS"],na.rm = T), alpha=.2, fill='#7FD2FF')+
  annotate("text", x = c(as.Date("2018-06-01")), y = max(TS_data3$MA_vals[TS_data3$document == "MPS"],na.rm = T) - 1, label = "TB1", family = "serif", fontface="bold")+
  # ADD TIME BREAK 2
  annotate('rect', xmin=as.Date("2020-01-01"), xmax=as.Date("2020-09-01"), ymin=min(TS_data3$MA_vals[TS_data3$document == "MPS"] ,na.rm = T), ymax=max(TS_data3$MA_vals[TS_data3$document == "MPS"],na.rm = T), alpha=.2, fill="#00C19B")+
  annotate("text", x = c(as.Date("2020-05-01")), y = max(TS_data3$MA_vals[TS_data3$document == "MPS"],na.rm = T) - 1, label = "TB2", family = "serif", fontface="bold")+
  #labels of the Figure
  labs(title = "",
        x = "",
        y = " FSZ score",
    color = "")+
    theme_tufte(base_family = "serif",
            base_size = 11)+
  #scale_color_brewer(palette="Set1")+
  #scale_color_manual(values = winter)+
  #scale_color_economist()+
  #scale_color_manual(values = paletteer_d("tidyquant::tq_dark"))+
      theme(legend.position = "none", # position and type of labels
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 11),
        strip.text.y = element_markdown(hjust = 0,
                                        size = 11, 
                                        face = "bold"))+
        #legend.background = element_text(face = "bold"))+
  scale_x_date(date_breaks = "2 year", # change x-axis breaks and format
               date_labels = "%Y") +
  # split the figure using the type of document
  facet_grid(
             rows =vars(document)
             , scales = "free")


#___________________________________

# MPM graph

#____________________________________

library(scales)
MPMplot <- TS_data3%>%
  filter(document == "MPM") %>%
    ggplot +
    geom_line(aes(x= dates, # aesthetics
               y= MA_vals),
              color = "#C40003")+
  # ADD TIME BREAK 1
  annotate('rect', xmin=as.Date("2015-01-01"), xmax=as.Date("2015-09-01"), ymin=min(TS_data3$MA_vals[TS_data3$document == "MPM"] ,na.rm = T), ymax=max(TS_data3$MA_vals[TS_data3$document == "MPM"],na.rm = T), alpha=.2, fill="#EAC862")+
  annotate("text", x = c(as.Date("2015-05-01")), y = max(TS_data3$MA_vals[TS_data3$document == "MPM"],na.rm = T) - 1, label = "TB1", family = "serif", fontface="bold")+
  # ADD TIME BREAK 2
  annotate('rect', xmin=as.Date("2020-01-01"), xmax=as.Date("2020-09-01"), ymin=min(TS_data3$MA_vals[TS_data3$document == "MPM"] ,na.rm = T), ymax=max(TS_data3$MA_vals[TS_data3$document == "MPM"],na.rm = T), alpha=.2, fill="#00C19B")+
  annotate("text", x = c(as.Date("2020-05-01")), y = max(TS_data3$MA_vals[TS_data3$document == "MPM"],na.rm = T) - 5, label = "TB2", family = "serif", fontface="bold")+
  #labels of the Figure
  labs(title = "",
        x = "",
        y = "FSZ score",
    color = " ")+
    theme_tufte(base_family = "serif",
            base_size = 11)+
  #scale_color_brewer(palette="Set1")+
  #scale_color_manual(values = winter)+
  #scale_color_economist()+
  #scale_color_manual(values = paletteer_d("tidyquant::tq_dark"))+
  theme(legend.position = "none",
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        strip.text.y = element_markdown(hjust = 0,
                                        size = 11, 
                                        face = "bold"))+
  scale_x_date(date_breaks = "2 year", # change x-axis breaks and format
               date_labels = "%Y") +
  scale_y_continuous(
  labels = label_number(accuracy = 1))+
  # split the figure using the type of document
  facet_grid(
             rows =vars(document)
             , scales = "free")

#___________________________________

  # QIR graph

#____________________________________



#TS_data3$document[TS_data3$document == "IQR"] ="QIR"
#A <- TS_data3 %>%
 # filter(document == "QIR")
#A <- A[2:144,]

#TS_data3$MA_vals[TS_data3$document == "IQR"] <- na.approx(TS_data3$MA_vals[TS_data3$document == "IQR"])




IQRplot <- IQR%>%
  filter(document == "QIR") %>%
      ggplot(aes(x = dates, # aesthetics
                 y= `Flesch-Szigriszt`)) +
    geom_line(color = "#C40003")+
  # ADD TIME BREAK 1
  annotate('rect', xmin=as.Date("2018-01-01"), xmax=as.Date("2018-12-01"), ymin=min(IQR$`Flesch-Szigriszt` ,na.rm = T), ymax=max(IQR$`Flesch-Szigriszt`,na.rm = T), alpha=.2, fill='#7FD2FF')+
  annotate("text", x = c(as.Date("2018-06-01")), y = max(IQR$`Flesch-Szigriszt`,na.rm = T) - 1, label = "TB1", family = "serif", fontface="bold")+
  # ADD TIME BREAK 2
  annotate('rect', xmin=as.Date("2020-01-01"), xmax=as.Date("2020-09-01"), ymin=min(IQR$`Flesch-Szigriszt` ,na.rm = T), ymax=max(IQR$`Flesch-Szigriszt`,na.rm = T), alpha=.2, fill="#00C19B")+
  annotate("text", x = c(as.Date("2020-05-01")), y = max(IQR$`Flesch-Szigriszt`,na.rm = T) - 1, label = "TB2", family = "serif", fontface="bold")+
  #labels of the Figure
  labs(title = "",
       subtitle = "",
        x = "",
        y = " FSZ score",
    color = " ",
      caption = "<br>**Figure 6**: Structural breaks in Banco de México's communication.<br><br>Source: Author's calculation.")+
    theme_tufte(base_family = "serif",
            base_size = 11)+
  #scale_color_brewer(palette="Set1")+
  #scale_color_manual(values = winter)+
  #scale_color_economist()+
  #scale_color_manual(values = paletteer_d("tidyquant::tq_dark"))+
  theme(legend.position = "none",
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        strip.text.y = element_markdown(hjust = 0,
                                        size = 11, 
                                        face = "bold"))+
  scale_x_date(date_breaks = "2 year", # change x-axis breaks and format
               date_labels = "%Y") +
  #ylim(44,54)+
  #scale_y_continuous(breaks = c(46,50,54),limits = c(46,54),)+
  # split the figure using the type of document
  facet_grid(
             rows =vars(document)
             , scales = "free")
```

\noindent
```{r Figure 7 LOCF data, echo=FALSE, fig.height=7, message=FALSE, warning=FALSE}

library(latex2exp)
library(ggtext)
library(grid)
library(gridExtra) 



##__________________________

# MULTIPLOT

##__________________________

#multiplot(MPMplot,MPSplot,IQRplot, cols = 1)

grid.arrange(MPMplot,MPSplot,IQRplot, heights = c(2,2,3))
```



# 6. Conclusion

Overall, effective communication is critical to the success of central banks, as it can help to ensure that their policy decisions are well understood, well received, and aligned with the broader economic goals of the society they serve.

Inflation-targeting central banks, in particular, need to communicate with the public and be transparent to foster openness and accountability. Given the great power that they have to potentially influence expectations and affect the economy, it is not only important to increase the amount of information available but also make it accessible to as many people as possible. 

In this regard, Banco de México has made significant progress in improving transparency and communication since the adoption of its Inflation Targeting Regime in 2001. The bank has implemented various communication channels to increase transparency and improve public understanding of its policy decisions.

One of the most notable communication channels used by Banxico is its regular bulletins, which provide detailed explanations of the bank's policy decisions, including the factors that influenced those decisions. These bulletins are released immediately after each monetary policy meeting and are widely read by investors, economists, and the general public.

Additionally, Banxico publishes quarterly reports that analyze inflation and economic developments in the country, which serve to provide the public with a deeper understanding of the bank's policy objectives and actions. These reports also include forecasts for key economic variables such as inflation, GDP growth, the exchange rate, and the balance of risk, whcih provide useful information to market participants, firms and households in general.

In addition, Banxico has made efforts to improve transparency about the decision-making process, providing minutes of the monetary policy meetings since 2011. Also, since 2021, the central bank publishes transcripts of these meetings with a three-year delay, making transcripts for 2018, 2019 and part of 2020 available so far.

Furthermore, in 2018 the central bank shifted its monetary policy strategy to one focus on inflation forecast, and in 2020 updated the General Communication Criteria for the Board of Directors and Banxico’s staff.

All of these events have undergone major changes in the accessibility and clarity of the central bank's communication materials. Especially, the statistical evidence provided in this paper suggests that there is a negative correlation between the length of the publications and clarity levels. Over the years, monetary policy statements have decreased in length and have become clearer than ever before. 

Quarterly reports also show a negative relation, although this is way more weaker than in the statements. It is reasonable to think that this is due to the fact that the reports are long documents with a lot of descriptive information on the economy over the previous quarter, the central banks forecast and balance of risk. Thus, in spite of the efforts of the central to make clearer these documents, it is quite difficult to summarize this amount of information.

On the other hand, the minutes show a direct relationship, pointing out that the longer they are, i.e., the more information there is about the decision-making process, the clearer the communication. The latter seems to be true, especially after the publications reveal the identity of the voters and include a section explaining the reasons for the dissenters' vote.

The results derived from the structural break analysis suggest that there are at least two positive breaks in each of the series. Minutes present a first independent break at the beginning of 2015. This date is not aligned with any major developments in Banxico's communication strategy. Quarterly Reports and Statements show evidence of a first-time break in 2018, which is consistent with all the evolution that the monetary policy and communication strategy underwent in this year.

The second time break is not significantly different for all of the series. Therefore, the structural change is set rather ad-hoc to have occurred between the first and third quarter of 2020. This is consistent with two major events: the update of the central bank's communication criteria and the COVID-19 pandemic. Since then, we have seen the clarity of the central bank's publications increase.

These findings are very informative about the developments on Banxico's communication over time. However, further developments could focus on address the limitations that traditional readability and perspicuity measures impose to economic and financial documents. Moreover, although the statistical methods performed are considered robust for traditional time series, the results should be interpret carefully as the MPMs and MPSs perspicuity observations are not collected on a regular monthly frequency.

That said, this paper represents a first approximation to measure the clarity of Banco de México's communication, and its evolution over time. Have there been significant changes in Banco de México's communication over time? Overall, Yes. Banxico's communication strategy has undergone several modifications over the years, as the bank has worked to improve its effectiveness and transparency. Has the information shared by the central bank become more accessible to the majority of the population? All these changes have led to an upward trend in the readability and perspicuity of the central bank, however, Banxico's main publications still lag behind in clarity, as the average difficulty requires at least a high school education, while the majority of the population has only basic education (primary and secondary) or no schooling, and the average years of schooling have remained at levels equivalent to junior high education.



# References

<div id="refs"></div>




\newpage
# Appendix A. Readability and Perspicuity Formulas

In the search for the adaptation of the readability formulas to the texts written in Spanish, José Fernández Huerta [-@fernandezhuertaMedidasSencillasLecturabilidad1959] developed a first measure to test the reading ease of a wide variety of Spanish documents. The Fernández Huerta test is based on the famous Flesch test and they have similar readability scale. The formula is as follows:


\begin{equation}
   FH = 206.835 - 1.02 * \frac{W}{St} - 60 * \frac{Sy}{W}
\end{equation}



```{r FH scale, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
library(xtable)
FLESCH.SCALE <- data.frame("Score" = c("90-100","80-90","70-80",
                                       "60-70","50-60","30-50",
                                       "0-30"),
                           "Level" = c("Very easy",
                                       "Easy",
                                       "Fairly easy",
                                       "Standard",
                                       "Fairly difficult",
                                       "Difficult",
                                       "Very difficult"),
                           "Grade" = c("5th grade", "6 grade",
                                       "7th", "8th-9th grade",
                                       "High school",
                                       "University",
                                       "Graduate student"), row.names = NULL)

color_FH = c(rep("#F7FBFF",1),rep("#DEEBF7",1),rep("#C6DBEF",1),
              rep("#9ECAE1",1),rep("#6BAED6",1),rep("#4292C6",1),
              rep("#2171B5",1))
color_FH = rev(color_FH)

rownames(FLESCH.SCALE) <- NULL

xtable2kable <- function(x) {
  out <- capture.output(print(x, table.placement = NULL))[-(1:2)]
  out <- paste(out, collapse = "\n")
  structure(out, format = "latex", class = "knitr_kable")
}

xtable(FLESCH.SCALE,
             caption = "FH Readability Scale",
             #align = "c",
             booktabs = T,
       include.rownames = FALSE,
       label = NULL)  %>%
  xtable2kable( ) %>%
  kable_styling(#latex_options = c("hold_position"),
                font_size = 11,
                position = "float_left", 
                full_width = F) %>%
  column_spec(3, background = color_FH,
              color = "black", bold = T) %>%
  column_spec(1, width = "0cm", color="white") %>%
  add_footnote("Source: Fernández Huerta J.(1959).",
               notation = "none")

```



\noindent where $\frac{W}{St}$ is the average sentence length and $\frac{Sy}{W}$ is the average number of syllables per word. The intuition behind this formula is that the larger the sentences and the more syllables per word, the more difficult it is to understand and read a text. 


```{r FH scale 2, echo=FALSE, message=FALSE, warning=FALSE}
library(xtable)
FLESCH.SCALE <- data.frame("Score" = c("90-100","80-90","70-80",
                                       "60-70","50-60","30-50",
                                       "0-30"),
                           "Level" = c("Very easy",
                                       "Easy",
                                       "Fairly easy",
                                       "Standard",
                                       "Fairly difficult",
                                       "Difficult",
                                       "Very difficult"),
                           "Grade" = c("5th grade", "6 grade",
                                       "7th grade", "8th-9th grade",
                                       "High school",
                                       "University",
                                       "Graduate student"), row.names = NULL)

color_FH = c(rep("#F7FBFF",1),rep("#DEEBF7",1),rep("#C6DBEF",1),
              rep("#9ECAE1",1),rep("#6BAED6",1),rep("#4292C6",1),
              rep("#2171B5",1))
color_FH = rev(color_FH)

rownames(FLESCH.SCALE) <- NULL



kable(FLESCH.SCALE,
             caption = "FH Readability Scale",
             align = "c",
             booktabs = T,
             linesep = "")  %>%
  #xtable2kable( ) %>%
  kable_styling(latex_options = c("hold_position"),
                font_size = 11,
                position = "center", 
                full_width = F) %>%
  column_spec(2, background = color_FH,
              color = "black", bold = T) %>%
  #column_spec(1, width = "0cm", color="white") %>%
    column_spec(2:3, width = "4.5cm") %>%
 # column_spec(4, width = "5cm") %>%
  add_footnote("Source: Fernández Huerta J.(1959).",
               notation = "none")

```

Later in the 1990s, Francisco Szigrist Pazos [-@szigrisztpazosSistemasPredictivosLegilibilidad1992] developed a new validated formula for readability as his doctoral thesis at the Universidad Complutense de Madrid. This test is also an adaptation of the Flesch test for Spanish and French written texts. The main difference is that Szigrist Pazos' formula yields a perspicuity score instead a readability measure.


As part of the validation of the perspicuity test for the Spanish language, Szigriszt used the proposed criterion prediction, the comparative validity strategy, and a foreign criterion prediction. All the validity tests implemented by Szigriszt yielded statistically significant results, which made Szigriszt one of the modern precursors in the development of readability formulas for Spanish in the last decades.[^34]

[^34]: See @rioshernandezInfluenciasLenguajeOrigen2009.

One of the major advantages of using Szigriszt's formula is that it is applicable to the use of printed Spanish text in publications of various thematic focuses. The Szigriszt formula also establishes the levels of difficulty of a text and its categorization, based on the coefficient of perspicuity obtained from the mathematical calculation performed as established in its formula.


\begin{equation}
  SZ = 207 - \frac{W}{St} - (62.3 * \frac{Sy}{W})
\end{equation}


```{r Szigriszt Score, echo=FALSE}
FLESCH.SCALE <- data.frame("Score" = c("85-100",  "75-85", "65-75",
                                       "50-65","35-50","15-35",
                                       "0-15"),
                           "Szigriszt" = c(rep("Very easy",1), rep("Easy", 1),
                                           rep("Fairly easy",1),rep("Standard",1), 
                                           rep("Fairly difficult",1), 
                                           rep("Difficult",1), 
                                           rep("Very difficult",1)),
                           "Grade" = c("6th-10th grade", "11th grade",
                                       "12th grade", 
                                       "Popular",
                                       "High School",
                                       "University",
                                       "Graduate Student"),
                           "Type" = c("Comics", 
                                      "Entertainment",
                                      "Novels",
                                      "News and Media",
                                      "Disemination",
                                      "Technical",
                                     "Scientific"))

color_FSZ = c(rep("#F7FBFF",1),rep("#DEEBF7",1),rep("#C6DBEF",1),
              rep("#9ECAE1",1),rep("#6BAED6",1),rep("#4292C6",1),
              rep("#2171B5",1))
color_FSZ = rev(color_FSZ)

kable(FLESCH.SCALE,
             caption = "INFLESZ Perspicuity Scale for Spanish Language",
             align = "c",
             booktabs = T,
             linesep = "")%>%
  #xtable2kable( ) %>%
  kable_styling(latex_options = c("hold_position"),
                font_size = 11,
                position = "center", 
                full_width = F) %>%
  column_spec(2, background = color_FSZ,
              color = "black", bold = T) %>%
  #column_spec(1, width = "0cm", color="white") %>%
  column_spec(2:4, width = "4cm") %>%
  add_footnote("Source: Szigriszt, F. (1993).",
               threeparttable = F,
               notation = "none")
```



In a later work, @barriocantalejoMedicionLegibilidadTextos2003 adapted the Szigriszt-Pazos scale of interpretation of results, creating the INFLESZ scale and a new validated perspicuity formula, the Flesch-Szigritsz.


\begin{equation}
  FSZ = 206.835 - 62.3 (\frac{Sy}{W} - \frac{W}{St})
\end{equation}


```{r Table 4 Flesch-Szigriszt Score, echo=FALSE}
FLESCH.SCALE <- data.frame("Score" = c("80-100",
                                       "65-80","55-65","40-55",
                                       "0-40"),
                           "Level" = c("Very easy",
                                       "Easy",
                                       "Average",
                                       "Fairly difficult",
                                       "Very difficult"),
                           "Grade" = c("Elementary", "Elementary",
                                       "Junior high", 
                                       "High school",
                                       "Univeristy"),
                           "Type" = c("Comics", 
                                      "Entertainment and novels",
                                      "General and Sport press",
                                      "Quality magazines",
                                     "Scientific"))

color_INFLESZ = c(rep("#F7FBFF",1),rep("#C6DBEF",1),rep("#9ECAE1",1),
                  rep("#6BAED6",1),rep("#2171B5",1))
color_INFLESZ = rev(color_INFLESZ)

kable(FLESCH.SCALE,
             caption = "INFLESZ Perspicuity Scale for Spanish Language",
             align = "c",
             booktabs = T)%>%
  #xtable2kable( ) %>%
  kable_styling(latex_options = c("hold_position"),
                font_size = 11,
                position = "center", 
                full_width = F) %>%
  column_spec(2, background = color_INFLESZ,
              color = "black", bold = T) %>%
  #column_spec(1, width = "0cm", color="white") %>%
  column_spec(2:3, width = "3cm") %>%
  column_spec(4, width = "5cm") %>%
  add_footnote("Source: See Barrio-Cantalejo et al. (2008).",
               threeparttable = F,
               notation = "none")
```


\newpage
# Appendix B. Linguistic Correlation Maps

\noindent
```{r Apenndix B Correlation Maps, echo=FALSE, fig.height=6, fig.width=6, message=FALSE, warning=FALSE}
#install.packages("GGally")
library(GGally)
source("multiplot.R")
library(paletteer)
library(latex2exp)
library(ggtext)
library(grid)
library(gridExtra)

A<- Banxico_readability %>%
  dplyr::mutate("Year" = format(dates, 
                                format="%Y"),
                "Fernández Huerta" = `Fernandez Huerta`,
                "Flesch-Szigriszt" = `Flesch-Szigriszt`,
                "Readability Mu" = Readability_MU,
                "Avg" = (`Fernandez Huerta` + `Flesch-Szigriszt`+ 
                        `Readability Mu` +  Szigriszt)/4) %>%
  dplyr::filter(Year %in% 2011:2022)

COR <- A %>%
  select(dates,Year,document,words,sentences,
         `Flesch-Szigriszt`,`Fernandez Huerta`,
         Szigriszt, Avg) %>%
  mutate(sentences = as.numeric(sentences),
         words = as.numeric(words)) %>%
  group_by(document)

A<-COR %>%
  filter(document == "MPS") %>%
  mutate(W = words,
         ST = sentences,
         FSZ = `Flesch-Szigriszt`,
         FH = `Fernandez Huerta`,
         #Gut = Gutierrez,
         ZS = Szigriszt,
         #Mu = `Readability Mu`,
         ) %>%
  select(W,ST,FSZ,
         FH,ZS,Avg) %>%
  ggcorr(label = F,
         geom = "tile",
         family = "serif",
         label.size  = 4,
         low = "#CB1618",
         #mid = "#F5B35E",
         high = "#2F327D") +
  theme(legend.position = "none",
        text = element_text(family = "serif"),
        plot.caption = element_text(hjust = 0),
        plot.subtitle = element_text(hjust = 0,
                                        size = 12,
                                     family = "serif", face = "bold"),
        plot.caption.position = "plot")+
  #scale_color_continuous(type = paletteer_c("ggthemes::Sunset-Sunrise Diverging",30))+
  #scale_fill_manual(values =  paletteer_c("ggthemes::Sunset-Sunrise Diverging"))+
  #scale_color_manual(values =  paletteer_c("ggthemes::Sunset-Sunrise Diverging"))+
  labs(title = "",
       subtitle = "
       MPS")


B<-COR %>%
  filter(document == "MPM") %>%
  mutate(W = words,
         ST = sentences,
         FSZ = `Flesch-Szigriszt`,
         FH = `Fernandez Huerta`,
         #Gut = Gutierrez,
         ZS = Szigriszt,
         #Mu = `Readability Mu`,
         ) %>%
  select(W,ST,FSZ,
         FH,ZS,Avg) %>%
  ggcorr(label = F,
         geom = "tile",
         family = "serif",
         label.size  = 4,
         low = "#CB1618",
         #mid = "#F5B35E",
         high = "#2F327D") +
        theme(legend.position = "none", # position and type of labels
        plot.caption = element_text(hjust = 0,
                                        size = 11,
                                    family = "serif"),
        plot.caption.position = "plot",
        plot.subtitle = element_text(hjust = 0,
                                        size = 12,
                                     family = "serif", face = "bold"),
        strip.text.y = element_text(hjust = 0,
                                        size = 11, 
                                        face = "bold", family = "serif")) +
  #scale_fill_manual(values =  paletteer_c("ggthemes::Sunset-Sunrise Diverging"))+
  #scale_color_manual(values =  paletteer_c("ggthemes::Sunset-Sunrise Diverging"))+
  #scale_color_continuous(type = paletteer_c("ggthemes::Sunset-Sunrise Diverging",30))+
  labs(title =" ",subtitle = "
       MPM")

C<-COR %>%
  filter(document == "QIR") %>%
  mutate(W = words,
         ST = sentences,
         FSZ = `Flesch-Szigriszt`,
         FH = `Fernandez Huerta`,
         #Gut = Gutierrez,
         ZS = Szigriszt,
         #Mu = `Readability Mu`,
         ) %>%
  select(W,ST,FSZ,
         FH,ZS,Avg) %>%
  ggcorr(label = F,
         geom = "tile",
         family = "serif",
         label.size  = 4,
         low = "#CB1618",
         #mid = "#F5B35E",
         high = "#2F327D")+
    theme(legend.position = "none",
          text = element_text(family = "serif"),
        plot.caption = element_text(hjust = 0),
        plot.subtitle = element_text(hjust = 0,
                                        size = 12,
                                     family = "serif", face = "bold"),
        plot.caption.position = "plot") +
  #scale_fill_manual(values =  paletteer_c("ggthemes::Sunset-Sunrise Diverging"))+
  #scale_color_manual(values =  paletteer_c("ggthemes::Sunset-Sunrise Diverging"))+
  #scale_color_continuous(type = paletteer_c("ggthemes::Sunset-Sunrise Diverging",30))+
  labs(title =" ",subtitle = "
       QIR")

C2<-COR %>%
  filter(document == "QIR") %>%
  mutate(W = words,
         ST = sentences,
         FSZ = `Flesch-Szigriszt`,
         FH = `Fernandez Huerta`,
         #Gut = Gutierrez,
         ZS = Szigriszt,
         #Mu = `Readability Mu`,
         ) %>%
  select(W,ST,FSZ,
         FH,ZS,Avg) %>%
  ggcorr(label = F,
         geom = "tile",
         family = "serif",
         label.size  = 4,
         low = "#CB1618",
         #mid = "#F5B35E",
         high = "#2F327D")+
    theme(
          text = element_text(family = "serif"),
        plot.caption = element_text(hjust = 0),
        plot.subtitle = element_text(hjust = 0,
                                        size = 12,
                                     family = "serif", face = "bold"),
        plot.caption.position = "plot") +
  #scale_fill_manual(values =  paletteer_c("ggthemes::Sunset-Sunrise Diverging"))+
  #scale_color_manual(values =  paletteer_c("ggthemes::Sunset-Sunrise Diverging"))+
  #scale_color_continuous(type = paletteer_c("ggthemes::Sunset-Sunrise Diverging",30))+
  labs(title =" ",subtitle = "
       QIR")

as_ggplot <- function(x){

  # Open null device to avoid blank page before plot------
  # see cowplot:::as_grob.ggplot
  null_device <- base::getOption(
    "ggpubr.null_device",
    default = cowplot::pdf_null_device
  )
  cur_dev <- grDevices::dev.cur()
  # Open null device to avoid blank page before plot
  null_device(width = 6, height = 6)
  null_dev <- grDevices::dev.cur()
  on.exit({
    grDevices::dev.off(null_dev)
    if (cur_dev > 1) grDevices::dev.set(cur_dev)
  })

  # Convert to ggplot-------------
  cowplot::ggdraw() +
    cowplot::draw_grob(grid::grobTree(x))
}

legend <- cowplot::get_legend(C2)
legend <- as_ggplot(legend)

  
multiplot(A,B,C,legend,
          cols = 2)

rm(A,B,C, legend, C2)
```


> \noindent \footnotesize Source: Author's calculation.


\noindent __Avg__: Standard mean of the three readability measures.

\noindent __ZS__: Szigriszt Pazos score.

\noindent __FH__: Fernández Huerta score.

\noindent __FSZ__: Flesch-Szigriszt score.

\noindent __ST__: Sentence count.

\noindent __W__: Word count.


\newpage
# Appendix C. Classic Unit Root Test Results


```{r echo=FALSE}
Clasic_Unit <- data.frame( Model = c("Type 1","Type 1",
                                     "Type 2","Type 2",
                                     "Type 3","Type 3"),
                           "ADF(4)" = c(0.514,"(0.790)",-0.387,"(0.905)",-2.06,"(0.548)"),
                           "PP(4)" = c(0.015,"(0.693)",-1.77,"(0.793)",-5.87,"(0.738)"),
                           "KPS(2)" = c(0.437,"(>0.1)",0.485,"(0.045)**",0.051,"(>0.1)"),
                           "ADF(4)" = c(0.548,"(0.80)",-1.27,"(0.599)",-2.04,"(0.557)"),
                           "PP(4)" = c(0.024,"(0.695)",-3.17,"(0.633)",-6.78,"(0.669)"),
                           "KPS(2)" = c(0.331,"(>0.1)",0.355,"(0.096)*",0.072,"(>0.1)"),
                           "ADF(3)" = c(0.173,"(0.689)",-1.97,"(0.339)",-1.59,"(0.732)"),
                           "PP(3)" = c(0.015,"(0.688)",-16.4,"(0.021)**",-1.6,"(0.136)"),
                           "KPS(1)" = c(0.105,"(>0.1)",0.206,"(>0.1)",0.203,"(0.014)**")                          )

knitr::kable(Clasic_Unit,
             caption = "Classic Unit Root Tests",
             align = "c",
             booktabs = T,
             col.names = c(" ","ADF(4)","PP(4)" ,"KPS(2)",
                "ADF(4)","PP(4)" ,"KPS(2)",
                "ADF(3)","PP(3)" ,"KPS(1)")) %>%  
    kable_styling(latex_options = c("hold_position","scale_down"),
                  full_width = T,font_size = 10) %>%
    collapse_rows(columns = 1, latex_hline = "major", valign = "middle") %>%
    #column_spec(3, background = color,
     #         color = "black",bold = T) %>%
      #column_spec(4, background = color,
       #       color = "black",bold = T)  %>%
    add_header_above(c(" " = 1, "MPM" = 3, "MPS" = 3, "QIR" = 3),
                     bold = T, font_size = 10)%>%
    add_footnote(c("Source: Author's calculation."),
                 notation = "none",
                 threeparttable = F)


```


```{r echo=FALSE, message=FALSE, warning=FALSE}
Clasic_Unit_MPS<- data.frame(
                           Model = c("Type 1","Type 1",
                                     "Type 2","Type 2",
                                     "Type 3","Type 3"),
                           "ADF(4)" = c(-0.205,"(0.584)",-3.95,"(<0.01)***",-4.67,"(<0.01)***"),
                           "PP(4)" = c(-0.023,"(0.684)",-16.8,"(0.023)**",-17.9,"(0.093)*"),
                           "KPS(2)" = c(0.112,"(>0.1)",0.064,"(>0.1)",0.067,"(>0.1)"),
                           "ADF(4)" = c(-0.339,"(0.546)",-4.11,"(<0.01)***",-4.95,"(<0.01)***"),
                           "PP(4)" = c(-0.030,"(0.682)",-17.5,"( 0.020)**",-19.2,"(0.072)*"),
                           "KPS(2)" = c(0.080,"(>0.1)",0.063,"(>0.1)",0.059,"(>0.1)"))

Clasic_Unit_QIR<- data.frame(
                           Model = c("Type 1","Type 1",
                                     "Type 2","Type 2",
                                     "Type 3","Type 3"),
                           "ADF(3)" = c(-0.841,"(0.370)",-1.77,"(0.413)",-3.86,"(0.030)**"),
                           "PP(2)" = c(-0.018,"(0.676)",-9.3,"(0.165)",-25.1,"(<0.01)***"),
                           "KPS(1)" = c(0.053,"(>0.1)",0.508,"(0.039)**",0.066,"(>0.1)"),
                           "ADF(3)" = c(-0.839,"(0.370)",-1.82,"(0.397)",-3.77,"(0.036)**"),
                           "PP(2)" = c(-0.014,"(0.677)",-9.55,"(0.15)",-26.2 ,"(<0.01)***"),
                           "KPS(1)" = c(0.040,"(>0.1)",0.493 ,"(0.0433)**",0.068,"(>0.1)"))
knitr::kable(Clasic_Unit_MPS,
             caption = "MPS - Classic Unit Root Tests Before the Potencial Break",
             align = "c",
             booktabs = T,
             col.names = c(" ","ADF(4)","PP(4)" ,"KPS(2)",
                "ADF(4)","PP(4)" ,"KPS(2)")) %>%  
    kable_styling(latex_options = c("hold_position"),
                  full_width = T,font_size = 10) %>%
    collapse_rows(columns = 1, latex_hline = "major", valign = "middle") %>%
    #column_spec(3, background = color,
     #         color = "black",bold = T) %>%
      #column_spec(4, background = color,
       #       color = "black",bold = T)  %>%
    add_header_above(c(" " = 1, "Before Mar-20" = 3, "Before May-20" = 3),
                     bold = T, font_size = 10)%>%
    add_footnote(c("Source: Author's calculation."),
                 notation = "none")

knitr::kable(Clasic_Unit_QIR,
             caption = "QIR - Classic Unit Root Tests Before the Potencial Break",
             align = "c",
             booktabs = T,
             col.names = c(" ","ADF(3)","PP(2)" ,"KPS(1)",
                "ADF(3)","PP(2)" ,"KPS(1)")) %>%  
    kable_styling(latex_options = c("hold_position"),
                  full_width = T, font_size = 10) %>%
    collapse_rows(columns = 1, latex_hline = "major", valign = "middle") %>%
    #column_spec(3, background = color,
     #         color = "black",bold = T) %>%
      #column_spec(4, background = color,
       #       color = "black",bold = T)  %>%
    add_header_above(c(" " = 1, "Before Q2-18" = 3, "Before Q3-18" = 3),
                     bold = T, font_size = 10)%>%
    add_footnote(c("Source: Author's calculation."),
                 notation = "none")
```


\noindent Note: rejection of the null at ($*$)1% , ($**$)5% and ($***$)10% level.

\noindent Number in parenthesis after the test are the selected lags.

\noindent Number in parenthesis below the t-statics represents the correspondent p-value.




\newpage
# Appendix D. Histograms of Bootstrap Results.

\noindent
```{r Fig 6 Histograms of Bootstrap Results, echo=FALSE, fig.height=8, message=FALSE, warning=FALSE}

library(latex2exp)
library(ggtext)
library(grid)
library(gridExtra) 
library(ggplot2)
library(paletteer)
#_____________________________________________________________
# T-STAT
#_____________________________________________________________

#CV <- data.frame(MPM = as.numeric(MPM_BOOTS_INTERVALS[,1]),
 #                MPS = as.numeric(MPD_BOOTS_INTERVALS[,1]),
  #               QIR = as.numeric(IQR_BOOTS_INTERVALS[,1]))
#CV <- CV%>%
 #   pivot_longer(cols = 1:3, 
  #               values_to = "vals",
   #              names_to = "names")
                 
CVplot <- CV %>%
    group_by(names) %>%
    ggplot(aes(x = vals, fill = names)) +
    geom_histogram(aes(x = vals,y = ..density..,
                       fill = names),
                 #binwidth = 0.8,
                 alpha = 0.8,
                 binwidth = 0.3,
                 inherit.aes = F,
                 position = "dodge") +
    geom_density(lwd = 0.8,
               linetype = 1,
               colour = "black",
               alpha = 0.3,
               outline.type = "full",
                   )+
    labs( 
    title = " ",
        subtitle = "**t-stat**",
        x = "t-stat",
        y = "Density",
    color = " ",
    fill = " ",
    caption = "")+
  theme_tufte(base_family = "serif", # type of theme
            base_size = 11)+
    #scale_colour_wsj()+ # color palette
    #scale_fill_wsj()+
  #scale_fill_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  #scale_color_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  scale_fill_manual(values =  paletteer_d("tidyquant::tq_green"))+
  scale_color_manual(values =  paletteer_d("tidyquant::tq_green"))+
  #scale_x_date(date_breaks = "2 year", # change x-axis breaks and format
   #            date_labels = "%Y")+
    theme(legend.position = "none", # position and type of labels
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 11))
  # split the figure using the type of document
     # facet_grid(
      
    #       rows =vars(names), scales = "free_y")




#_____________________________________________________________
# FIRST BREAL
#_____________________________________________________________


#IQR$dates = as.Date(format(IQR$dates, format= "%Y-%m-01"))
#IQR$num <- 1:length(IQR$Q)

#MPM2$num <- 1:length(MPM2$dates)

#MPD2$num <- 1:length(MPD2$dates)


#TB1 <- data.frame(MPM = as.numeric(MPM_BOOTS_INTERVALS[,2]),
     #            MPS = as.numeric(MPD_BOOTS_INTERVALS[,2]),
      #           QIR = as.numeric(IQR_BOOTS_INTERVALS[,2]))

#TB11 <- TB1 %>%
#  mutate(MPM =NA,
#         MPS = NA,
#         QIR = NA)



#for (i in 1:1000) {
 # for (j in 1:length(MPM2$dates)) {
  #  if (MPM2$num[j] == TB1$MPM[i]) {
   #   TB11$MPM[i] <- as.Date(MPM2$dates[j])
      
  #  }
    
  #}
#}
#TB11$MPM <- as.Date(TB11$MPM)



#for (i in 1:1000) {
 # for (j in 1:length(MPD2$dates)) {
  #  if (MPD2$num[j] == TB1$MPS[i]) {
   #   TB11$MPS[i] <- as.Date(MPD2$dates[j])
      
  #  }
    
  #}
#}
#TB11$MPS <- as.Date(TB11$MPS)




#for (i in 1:1000) {
 # for (j in 1:length(IQR$dates)) {
  #  if (IQR$num[j] == TB1$QIR[i]) {
   #   TB11$QIR[i] <- as.Date(IQR$dates[j])
      
  #  }
    
  #}
#}
#TB11$QIR <- as.Date(TB11$QIR)







#TB11 <- TB11%>%
 #   pivot_longer(cols = 1:3, 
  #               values_to = "vals",
   #              names_to = "names")

                 
TB1plot <- TB11 %>%
    group_by(names) %>%
    ggplot(aes(x = vals, fill = names)) +
    geom_histogram(aes(x = vals,y = ..density..,
                       fill = names),
                 #binwidth = 0.5,
                 alpha = 0.8,
                 #binwidth = 10,
                 bins = 20,
                 inherit.aes = F,
                 position = "dodge") +
    geom_density(lwd = 0.8,
               linetype = 1,
               colour = "black",
               alpha = 0.3,
               outline.type = "full",
                   )+
    labs( 
    title = " ",
        subtitle = "**TB1**",
        x = "First break point",
        y = "Density",
    color = " ",
    fill = " ",
    caption = "")+
  theme_tufte(base_family = "serif", # type of theme
            base_size = 11)+
    #scale_colour_wsj()+ # color palette
    #scale_fill_wsj()+
    #scale_fill_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  #scale_color_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  scale_fill_manual(values =  paletteer_d("tidyquant::tq_green"))+
  scale_color_manual(values =  paletteer_d("tidyquant::tq_green"))+
  #scale_x_date(date_breaks = "2 year", # change x-axis breaks and format
   #            date_labels = "%Y")+
    theme(legend.position = "none", # position and type of labels
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 11))
  # split the figure using the type of document
     # facet_grid(
      
    #       rows =vars(names), scales = "free_y")

#rm(CV)
#rm(CV2)




#_____________________________________________________________
# Second Break
#_____________________________________________________________


#TB2 <- data.frame(MPM = as.numeric(MPM_BOOTS_INTERVALS[,3]),
 #                MPS = as.numeric(MPD_BOOTS_INTERVALS[,3]),
  #               QIR = as.numeric(IQR_BOOTS_INTERVALS[,3]))

#TB21 <- TB2 %>%
 # mutate(MPM =NA,
  #       MPS = NA,
   #      QIR = NA)



#for (i in 1:1000) {
 # for (j in 1:length(MPM2$dates)) {
  #  if (MPM2$num[j] == TB2$MPM[i]) {
   #   TB21$MPM[i] <- as.Date(MPM2$dates[j])
      
  #  }
    
#  }
#}
#TB21$MPM <- as.Date(TB21$MPM)



#for (i in 1:1000) {
 # for (j in 1:length(MPD2$dates)) {
  #  if (MPD2$num[j] == TB2$MPS[i]) {
   #   TB21$MPS[i] <- as.Date(MPD2$dates[j])
      
  #  }
    
#  }
#}
#TB21$MPS <- as.Date(TB21$MPS)




#for (i in 1:1000) {
 # for (j in 1:length(IQR$dates)) {
   # if (IQR$num[j] == TB2$QIR[i]) {
    #  TB21$QIR[i] <- as.Date(IQR$dates[j])
      
    #}
    
  #}
#}
#TB21$QIR <- as.Date(TB21$QIR)







#TB21 <- TB21%>%
 #   pivot_longer(cols = 1:3, 
  #               values_to = "vals",
   #              names_to = "names")

                 

TB2plot <- TB21 %>%
    group_by(names) %>%
    ggplot(aes(x = vals, fill = names)) +
    geom_histogram(aes(x = vals,y = ..density..,
                       fill = names),
                 #binwidth = 0.5,
                 alpha = 0.8,
                 binwidth = 160,
                 bins = 100,
                 inherit.aes = F,
                 position = "dodge") +
    geom_density(lwd = 0.8,
               linetype = 1,
               colour = "black",
               alpha = 0.3,
               outline.type = "full",
                   )+
    labs( 
    title = " ",
        subtitle = "**TB2**",
        x = "Second break point",
        y = "Density",
    color = " ",
    fill = " ",
    caption = "<br>Source: Author's calculation.")+
  theme_tufte(base_family = "serif", # type of theme
            base_size = 11)+
    #scale_colour_wsj()+ # color palette
    #scale_fill_wsj()+
    #scale_fill_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  #scale_color_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  scale_fill_manual(values =  paletteer_d("tidyquant::tq_green"))+
  scale_color_manual(values =  paletteer_d("tidyquant::tq_green"))+
  #scale_x_date(date_breaks = "2 year", # change x-axis breaks and format
   #            date_labels = "%Y")+
    theme(legend.position = "none", # position and type of labels
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 11))
  # split the figure using the type of document
     # facet_grid(
      
    #       rows =vars(names), scales = "free_y")

#rm(CV)
#rm(CV2)




TB21plot <- TB21 %>%
    group_by(names) %>%
    ggplot(aes(x = vals, fill = names)) +
    geom_histogram(aes(x = vals,y = ..density..,
                       fill = names),
                 #binwidth = 0.5,
                 alpha = 0.8,
                 binwidth = 160,
                 bins = 100,
                 inherit.aes = F,
                 position = "dodge") +
    geom_density(lwd = 0.8,
               linetype = 1,
               colour = "black",
               alpha = 0.3,
               outline.type = "full",
                   )+
    labs( 
    title = " ",
        subtitle = "**TB2**",
        x = "Second break point",
        y = "Density",
    color = " ",
    fill = " ",
    caption = "Source: Author's calculation.")+
  theme_tufte(base_family = "serif", # type of theme
            base_size = 11)+
    #scale_colour_wsj()+ # color palette
    #scale_fill_wsj()+
    #scale_fill_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  #scale_color_manual(values =  paletteer_d("tidyquant::tq_dark"))+
  scale_fill_manual(values =  paletteer_d("tidyquant::tq_green"))+
  scale_color_manual(values =  paletteer_d("tidyquant::tq_green"))+
  #scale_x_date(date_breaks = "2 year", # change x-axis breaks and format
   #            date_labels = "%Y")+
    theme(legend.position = "top", # position and type of labels
          legend.box = "horizontal",
        plot.caption = element_markdown(hjust = 0,
                                        size = 11),
        plot.caption.position = "plot",
        plot.subtitle = element_markdown(hjust = 0,
                                        size = 11),
        legend.text = element_markdown(hjust = 0,
                                        size = 11))

as_ggplot <- function(x){

  # Open null device to avoid blank page before plot------
  # see cowplot:::as_grob.ggplot
  null_device <- base::getOption(
    "ggpubr.null_device",
    default = cowplot::pdf_null_device
  )
  cur_dev <- grDevices::dev.cur()
  # Open null device to avoid blank page before plot
  null_device(width = 6, height = 6)
  null_dev <- grDevices::dev.cur()
  on.exit({
    grDevices::dev.off(null_dev)
    if (cur_dev > 1) grDevices::dev.set(cur_dev)
  })

  # Convert to ggplot-------------
  cowplot::ggdraw() +
    cowplot::draw_grob(grid::grobTree(x))
}

legend <- cowplot::get_legend(TB21plot)
#as_ggplot(legend)

#_____________________________________________________________
# MULTIPLOT
#_____________________________________________________________

multiplot(CVplot,TB2plot,TB1plot, as_ggplot(legend) , cols = 2)

```


